[
    {
        "content": "<p>I was trying to bump a project to v4.8.0-rc1 but encountered a strange error. It looked to me like a bug.</p>\n<p>MWE:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">Mathlib.Algebra.Module.Submodule.Basic</span>\n\n<span class=\"kd\">variable</span> <span class=\"o\">(</span><span class=\"n\">R</span> <span class=\"n\">M</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">CommRing</span> <span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">AddCommGroup</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">Module</span> <span class=\"n\">R</span> <span class=\"n\">M</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">N</span> <span class=\"o\">:</span> <span class=\"n\">Submodule</span> <span class=\"n\">R</span> <span class=\"n\">M</span><span class=\"o\">)</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span> <span class=\"n\">Nonempty</span> <span class=\"n\">N</span> <span class=\"c1\">-- succeeds with `instNonemptyOfInhabited`</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span> <span class=\"n\">Zero</span> <span class=\"n\">N.toAddSubgroup</span> <span class=\"c1\">-- succeeds with `N.toAddSubgroup.zero`</span>\n<span class=\"bp\">#</span><span class=\"n\">synth</span> <span class=\"n\">Nonempty</span> <span class=\"n\">N.toAddSubgroup</span> <span class=\"c1\">-- fails</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">:</span> <span class=\"n\">Nonempty</span> <span class=\"n\">N.toAddSubgroup</span> <span class=\"o\">:=</span>\n  <span class=\"n\">Zero.instNonempty</span>\n</code></pre></div>\n<p>As commented on above, the third <code>#synth</code> fails, even though the statement given can be <em>exactly</em> proved with the instance <code>Zero.instNonempty</code>, which in turn relies on the instance in the second <code>#synth</code>.</p>\n<p>Such an error did not occur in v4.7.0.</p>",
        "id": 437536817,
        "sender_full_name": "Peiran Wu",
        "timestamp": 1715118334
    },
    {
        "content": "<p>Thanks. We've noticed previously a problem with Nonempty instances, but I don't think we have a minimization.</p>",
        "id": 437545464,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715122544
    },
    {
        "content": "<p>If you <span class=\"user-mention\" data-user-id=\"258845\">@Peiran Wu</span>, or anyone else, would be interested in trying to extract a Mathlib free minimization of this problem, that would be really helpful.</p>",
        "id": 437545534,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715122567
    },
    {
        "content": "<p>(I can try too, but might not get to it immediately.)</p>",
        "id": 437545551,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715122581
    },
    {
        "content": "<p>I see. I'll play around with this later and see if I can avoid Mathlib dependency. But other people's help would definitely be appreciated.</p>",
        "id": 437550403,
        "sender_full_name": "Peiran Wu",
        "timestamp": 1715125668
    }
]