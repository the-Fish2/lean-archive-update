[
    {
        "content": "<p>I'm going to buy a new desktop computer because my current laptop needs 2.5h to compile Mathlib and my very old desktop is even slower. I have a problem: I know ~nothing about hardware. What numbers should I look at? Do you have specific recommendations?<br>\nP.S.: I would prefer to continue using Linux as an OS.</p>",
        "id": 410782619,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704161506
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/113488-general/topic/Computer.20for.20Lean/near/410782619\">said</a>:</p>\n<blockquote>\n<p>I'm going to buy a new desktop computer because my current laptop needs 2.5h to compile Mathlib and my very old desktop is even slower. I have a problem: I know ~nothing about hardware. What numbers should I look at? Do you have specific recommendations?<br>\nP.S.: I would prefer to continue using Linux as an OS.</p>\n</blockquote>\n<p>Ram is probably the most important thing since most of type checking involves caching a bunch of trees. But I'm not an expert</p>",
        "id": 410782789,
        "sender_full_name": "Frederick Pu",
        "timestamp": 1704161624
    },
    {
        "content": "<p>Both laptop and desktop have 16G RAM but laptop is 2x faster in building Mathlib.</p>",
        "id": 410782915,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704161688
    },
    {
        "content": "<p>My laptop has 2x more cores but each core is 2.5x slower (in GHz)</p>",
        "id": 410782978,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704161726
    },
    {
        "content": "<p>more cores and more RAM are the main numbers of interest (well, cores * clock speed but clock speed has been mostly stable for the past many years)</p>",
        "id": 410783105,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704161801
    },
    {
        "content": "<p>Where do I see \"clock speed\"?</p>",
        "id": 410783154,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704161841
    },
    {
        "content": "<p>I'd say for RAM, 16 GB minimum, but it's great having 32 GB so you can have multiple mathlibs and other projects open at once for experimentation. (64 GB is very nice to have)</p>\n<p>For CPU, get as many cores as you can afford, since this has the largest impact on mathlib compilation time as it's mostly parallelizable. I'm not sure how much GHz matters, since probably a lot of Lean compilation of memory-bound, but it doesn't hurt having more GHz if you can.</p>\n<p>For a hard drive, I think they're pretty much standard now, but a solid state drive I think has lower latency. I don't know much about this measurement.</p>",
        "id": 410783156,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1704161842
    },
    {
        "content": "<p>clock speed is the thing next to \"GHz\"</p>",
        "id": 410783169,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704161854
    },
    {
        "content": "<p>(More RAM also means more mathlib can be in cache rather than just on the hard drive.)</p>",
        "id": 410783264,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1704161890
    },
    {
        "content": "<p>hard disk volume is of course also important for your 17 chunky mathlib-based projects and the 30 chunky versions of lean they somehow manage to depend on</p>",
        "id": 410783363,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704161958
    },
    {
        "content": "<p>I have 8x\"11th Gen Intel(R) Core(TM) i7-1160G7 @ 1.20GHz\" on my laptop, 4x\"Intel(R) Core(TM) i5-3570 CPU @ 3.40 GHz\" on my desktop. Desktop is 2x slower than laptop in building Mathlib.</p>",
        "id": 410783377,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704161971
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113488-general/topic/Computer.20for.20Lean/near/410783363\">said</a>:</p>\n<blockquote>\n<p>hard disk volume is of course also important for your 17 chunky mathlib-based projects and the 30 chunky versions of lean they somehow manage to depend on</p>\n</blockquote>\n<p>I mostly work on branches of Mathlib (but this may change in a month).</p>",
        "id": 410783475,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704162015
    },
    {
        "content": "<p>well, I'm saying that you should watch the size of the <code>.elan</code> and <code>.cache/mathlib</code> directories</p>",
        "id": 410783502,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704162041
    },
    {
        "content": "<p>as well as <code>myproj/.lake</code> but this is bounded by the number of projects you have that depend on mathlib so if you only work on mathlib that doesn't grow without bound like the other two</p>",
        "id": 410783581,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704162106
    },
    {
        "content": "<p>Mario, can you say more about how to manage the <code>.elan</code> and <code>.cache/mathlib</code> directories?  I know I can use <code>elan toolchain uninstall</code> to get rid of toolchains I'm not using anymore.  My <code>cache/mathlib</code> directory has a long list of <code>.ltar</code> files, using 1.28 GB on my disk.  Do I need all that stuff?  Can I delete any of it, and if so how should I do it?</p>",
        "id": 410863639,
        "sender_full_name": "Dan Velleman",
        "timestamp": 1704209685
    },
    {
        "content": "<p>Don't delete the cache files at the moment, since we're having trouble with the server they come from</p>",
        "id": 410865170,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1704210432
    },
    {
        "content": "<p>Once we have our cache back (not yet!), you can delete <code>~/.cache/mathlib</code> and <code>lake exe cache update</code> will re-download whatever it needs.</p>",
        "id": 410869357,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704212179
    },
    {
        "content": "<p>See also <a href=\"https://github.com/JLimperg/elan-cleanup\">https://github.com/JLimperg/elan-cleanup</a></p>",
        "id": 410869465,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704212231
    },
    {
        "content": "<p>These directories are just full of versions of lean and mathlib which you happened to use on your computer at least once. You can periodically delete them and lake will just continue to download the leans and mathlibs which you use in future</p>",
        "id": 410869660,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1704212328
    },
    {
        "content": "<p>Together, my <code>.elan</code> and <code>.cache/mathlib</code> directories take up 18GB and 22GBâ€¦<br>\nHow can I know which stuff isn't of any use anymore?</p>",
        "id": 410906287,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1704229789
    },
    {
        "content": "<p>For <code>~/.elan</code>, I use <code>elan-cleanup</code> from time to time (after updating itself to use the same toolchain as <code>mathlib</code> does)</p>",
        "id": 410906372,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704229830
    },
    {
        "content": "<p>For <code>~/.cache/mathlib</code>, normally you can delete all files and let <code>lake exe cache get</code> download whatever is needed. However, right now the cache doesn't work, so I would not clear that folder before the cache is up again.</p>",
        "id": 410906444,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1704229886
    }
]