[
    {
        "content": "<p>I would like to start a conversation about PRing my work on <a href=\"https://github.com/asouther4/lean-social-choice\">Social Choice Theory in Lean</a>. Right now, my repo has two main files: </p>\n<ol>\n<li>\n<p>In the <code>basic</code> file, I have been slowly formalizing the first chapter of <a href=\"https://www.hup.harvard.edu/catalog.php?isbn=9780674919211\">Collective Choice and Social Welfare</a> by Amartya Sen.  I have just been working through and formalizing each definition and lemma as they come, without much thought yet towards building a user-friendly library. </p>\n</li>\n<li>\n<p>In the <code>arrows_theorem</code> file, I have formalized a proof of <a href=\"https://en.wikipedia.org/wiki/Arrow%27s_impossibility_theorem\">Arrow's Impossibility Theorem</a>. </p>\n</li>\n</ol>\n<p>Some maintainers have expressed interest in getting this work on mathlib. What should a PR look like for this work? Should I start with Arrow's Theorem and then PR bit-by-bit from there if people are interested in more? Where should I even plan to put these files? </p>\n<p><span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> once  suggested putting social choice theory and combinatorial game theory in their own home. I have long-term hopes to formalize more results in social choice theory, game theory, and microeconomic theory if that affects how we think about this.</p>",
        "id": 262196373,
        "sender_full_name": "Andrew  Souther",
        "timestamp": 1637431483
    },
    {
        "content": "<p>Start by opening some PR for the preliminary lemmas. Then you can PR Arrow's theorem in several go. I don't quite know where it belongs. <code>combinatorics.social</code> or <code>order.social</code> both sound like decent places to me.</p>",
        "id": 262196638,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1637431824
    },
    {
        "content": "<p>Also, I have been in contact with Eric Pacuit and Wesley Holliday who wrote <a href=\"https://arxiv.org/abs/2110.08453\">this paper</a> on Voting Theory in Lean. In the next few months, we plan to merge our code into one unified framework. They are real experts in social choice theory (I am not), and they have offered to help guide the conversation about design choices for a useful social choice library going forward.</p>",
        "id": 262196750,
        "sender_full_name": "Andrew  Souther",
        "timestamp": 1637431972
    },
    {
        "content": "<p>Then I would advise you to coordinate with them first. You do not have a huge amount of code, so PRing to mathlib should go smoothly. I see <span class=\"user-mention silent\" data-user-id=\"414747\">Eric Pacuit</span> is already here, by the way!</p>",
        "id": 262197147,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1637432451
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"366882\">@Andrew  Souther</span> I have a proof of arrow's theorem from Sen's book as well (so, the first three chapters) in Lean 4 where I made everything I could computable. What's the status on your work?</p>",
        "id": 389366134,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1693989259
    },
    {
        "content": "<p>As far as I can tell it's not in mathlib 4 is it?</p>",
        "id": 389366187,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1693989278
    },
    {
        "content": "<p>I haven't worked on this project much since I was a student in 2021. You're right, it never made it into mathlib. It's just sitting in an old GitHub repo. Congrats on your proof!</p>",
        "id": 389409102,
        "sender_full_name": "Andrew  Souther",
        "timestamp": 1694003438
    },
    {
        "content": "<p>I see thanks! I'm working towards publishing my version but I want to clean it up first, I'll update this thread once I have</p>",
        "id": 389426092,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694008202
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"282271\">@Bolton Bailey</span> don't be sad there's a brand new proof in Lean 4 <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 389426176,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694008220
    },
    {
        "content": "<p>Are you going to PR it?</p>",
        "id": 389562949,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694059323
    },
    {
        "content": "<p>Well once I improve the presentation and documentation I'd rather get feedback first. This is my first time working a proof that big, so I'm not sure it'll be up to mathlib's standards</p>",
        "id": 389929008,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694197326
    },
    {
        "content": "<p>I'm actually very confident it won't, starting with the syntax as I did not try to follow mathlib's conventions mostly because I don't know them</p>",
        "id": 389929274,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694197447
    },
    {
        "content": "<p>Actually the best way to get your code to mathlib standards is probably to open a pull request. Of course it’s better if you can start the job on your own, but you’ll probably get a lot more feedback by opening PRs than by sending some code on Zulip</p>",
        "id": 389940265,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1694202393
    },
    {
        "content": "<p>It just hit me that, since I'm doing the whole book (well, just the first three chapters currently), I'm using mostly custom typeclasses. For preorder/quasi-order/order for instance (though they imply mathlib's). So instead of cleaning everything I did I should probably just rewrite Arrow without custom classes</p>",
        "id": 390012265,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694249950
    },
    {
        "content": "<p>In particular I have a custom notion of <code>Finite</code>-ness, as I struggled to get a computable one from Mathlib. The main issue here is that it's my first time using Mathlib at all, in everything else I did I depended only on core and sometimes std4</p>",
        "id": 390012443,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694250071
    },
    {
        "content": "<p>What I'm saying is that I realize now we will probably never merge anything based on what I have right now, but I can try to write a version that's more Mathlib-friendly. The issue being time/energy/actual job <span aria-label=\"confused\" class=\"emoji emoji-1f615\" role=\"img\" title=\"confused\">:confused:</span></p>",
        "id": 390013705,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694250998
    },
    {
        "content": "<p>My repository is public now. It's far from where I wanted it to be before sharing it, but hopefully it will make the conversation easier</p>\n<ul>\n<li><a href=\"https://github.com/AdrienChampion/collChoSoWel\">https://github.com/AdrienChampion/collChoSoWel</a></li>\n</ul>",
        "id": 390014134,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694251333
    },
    {
        "content": "<p>For finite, was <code>Fintype</code> (maybe with decidable_eq and such) not good enough for you?</p>",
        "id": 390033590,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1694264640
    },
    {
        "content": "<p>Well the thing is, I needed a notion of finiteness early on and at that point I was still avoiding to depend on Mathlib...</p>",
        "id": 390045227,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694274339
    },
    {
        "content": "<p>In any case, I'll try my best to write a Mathlib-friendly version as soon as I find enough time, most likely using <code>Fintype</code> since my <code>Finite</code> class is kind of based on it</p>",
        "id": 390045419,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1694274523
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"380302\">Adrien Champion</span> <a href=\"#narrow/stream/113488-general/topic/Social.20Choice.20in.20mathlib/near/390045419\">said</a>:</p>\n<blockquote>\n<p>In any case, I'll try my best to write a Mathlib-friendly version as soon as I find enough time, most likely using <code>Fintype</code> since my <code>Finite</code> class is kind of based on it</p>\n</blockquote>\n<p>I'm currently working on this, but I'm struggling to get familiar enough with <code>Fintype</code>, <code>Finset</code>, <code>Multiset</code>, <code>Quot</code>... to write what I want, in particular computable definitions</p>",
        "id": 436247125,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714475699
    },
    {
        "content": "<p>I could use some mentoring on these things, maybe <span class=\"user-mention\" data-user-id=\"284160\">@Eric Rodriguez</span> or <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> ?</p>",
        "id": 436247382,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714475769
    },
    {
        "content": "<p>There is a <code>Finite</code> type in mathlib</p>",
        "id": 436317588,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1714496792
    },
    {
        "content": "<p>But in general if you want to enumerate the finite set, <code>Fintype</code> is the best bet.</p>",
        "id": 436321559,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1714498003
    },
    {
        "content": "<p>I'm pretty busy at my day job these days. I can answer specific questions (preferrably with some specific result you want to formalize).</p>",
        "id": 436447112,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1714537626
    },
    {
        "content": "<p>Generally,</p>\n<ul>\n<li>if you need cardinality, then <code>Fintype.card</code>/<code>Finset.card</code> have more API than noncomputable <code>Nat.card</code>/<code>Set.ncard</code> (though improvements for <code>Nat.card</code>/<code>Set.ncard</code> are welcome);</li>\n<li>if you don't need <code>[Fintype]</code> to <strong>state</strong> the theorem, then you can assume <code>Finite</code>, then do <code>cases nonempty_fintype α</code>, if you need it for the proof.</li>\n</ul>",
        "id": 436447572,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1714538039
    },
    {
        "content": "<p>I'm looking for mentoring in the general approach, I don't have a lot of experience writing complex proofs. My original proof was very \"dev-oriented\", for instance to show that a max exists in a (finite) quasi-preorder I would just fold over the list of elements and retrieve a max (see <a href=\"https://github.com/AdrienChampion/collChoSoWel/blob/main/Choice/Chapter1/Section2.lean#L560-L568\">here</a>)</p>",
        "id": 436488449,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714564789
    },
    {
        "content": "<p>But now that I'd like to write a mathlib version, I'm wondering whether it is idiomatic both for mathlib in general and <em>w.r.t.</em> how <code>Fintype</code> is supposed to be used in particular</p>",
        "id": 436488638,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714564874
    },
    {
        "content": "<p>To replace the previous, dev-oriented version, I currently have <a href=\"https://github.com/anzenlang/arrow.lean/blob/main/Arrow/Order/MaxBest.lean#L167-L205\">this</a></p>",
        "id": 436509359,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714573304
    },
    {
        "content": "<p>I'd like to get on the least-wrong track early to hopefully merge something in mathlib eventually, but as I'm very much a total noob in proof architecture it's proving difficult; not to mention I'm not super familiar with mathlib</p>",
        "id": 436509883,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1714573431
    },
    {
        "content": "<p>Hi Adrien, similarly to Yury I'm pretty busy sorry to say. Your code formatting is a little un-idiomatic - we tend not to indent for <code>namespace</code>, for example; <a href=\"https://leanprover-community.github.io/contribute/style.html\">#style</a> may be a good place to start there. It seems to me you wrote stuff in a very constructive way - is this your aim?</p>",
        "id": 437037578,
        "sender_full_name": "Eric Rodriguez",
        "timestamp": 1714843962
    },
    {
        "content": "<p>Note that most of <code>Mathlib</code> is non-constructive.</p>",
        "id": 437038964,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1714844865
    },
    {
        "content": "<blockquote>\n<p>It seems to me you wrote stuff in a very constructive way - is this your aim?</p>\n</blockquote>\n<p>Yes, as mentioned several times above being constructive whenever possible was a goal when I wrote the original version.</p>",
        "id": 437264639,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1715002850
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/113488-general/topic/Social.20Choice.20in.20mathlib/near/437038964\">said</a>:</p>\n<blockquote>\n<p>Note that most of <code>Mathlib</code> is non-constructive.</p>\n</blockquote>\n<p>Yes that's why I was wondering whether my approach made sense for merging in mathlib. Sadly it doesn't, and I don't have the skills nor the interest to do a non-constructive version. Would be a different story if I had infinite time/money as I wouldn't mind acquiring these skills, but I don't have infinite time/money so... <span aria-label=\"confused\" class=\"emoji emoji-1f615\" role=\"img\" title=\"confused\">:confused:</span></p>",
        "id": 437264951,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1715002950
    },
    {
        "content": "<p>I think your <code>Finite</code> is mathlib's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FinEnum%3F#doc\">docs#FinEnum?</a></p>",
        "id": 437269700,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1715004333
    },
    {
        "content": "<p>Also, I think things would be easier for you if you dropped <code>ProtoOrder</code> and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Preorder#doc\">docs#Preorder</a> instea</p>",
        "id": 437269936,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1715004380
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/113488-general/topic/Social.20Choice.20in.20mathlib/near/437269700\">said</a>:</p>\n<blockquote>\n<p>I think your <code>Finite</code> is mathlib's <code>FinEnum</code>?</p>\n</blockquote>\n<p>First time hearing about it, sounds right, thanks!</p>",
        "id": 437270113,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1715004426
    },
    {
        "content": "<p>Though unless your computation is really order-dependent, you should be able to use <code>Fintype</code> instead</p>",
        "id": 437270237,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1715004461
    },
    {
        "content": "<p>(but if you want to remain constructive, you should indeed avoid Mathlib's <code>Finite</code>)</p>",
        "id": 437270308,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1715004479
    },
    {
        "content": "<p>That's what the new <del>version</del> draft does</p>",
        "id": 437270388,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1715004491
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"380302\">@Adrien Champion</span> Would you like to see a constructive version of Mathlib?</p>",
        "id": 437289791,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1715010338
    },
    {
        "content": "<p>I don't think so no, I'm not sure it makes sense for most things in mathlib, does it?</p>",
        "id": 437290039,
        "sender_full_name": "Adrien Champion",
        "timestamp": 1715010409
    },
    {
        "content": "<p>I think Lean's library of constructive mathematics should be separated from Mathlib.</p>",
        "id": 437290387,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1715010519
    },
    {
        "content": "<p>In social choice theory, being constructive in some places is helpful since quite a few proofs are just algorithms</p>",
        "id": 437290632,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1715010597
    },
    {
        "content": "<p>But generally it is nice to pick and choose, since there are indeed existential results. For example the proof of existence EF1 indivisible allocations is constructive, while the proof of existence of envy free connected continuous cake division is existential</p>",
        "id": 437290953,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1715010686
    },
    {
        "content": "<p>If you keep the constructive version of your work, perhaps we can include it in ConsMath (Lean's constructive mathematics library) later.</p>",
        "id": 437291558,
        "sender_full_name": "Bulhwi Cha",
        "timestamp": 1715010863
    }
]