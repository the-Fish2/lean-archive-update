[
    {
        "content": "<p>While trying to understand what counts as a \"speed improvement\", I decided to run a test: seeing whether replacing <code>exact</code> by <code>refine</code> would have an effect on <code>!bench</code>.</p>\n<p>I created two branches.</p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/11935\">#11935</a> tests the speed of running <code>exact x</code> vs <code>refine x</code> and report the difference in heartbeats: an overwhelming <code>refine</code> win.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">refine</span> <span class=\"n\">is</span> <span class=\"n\">faster</span> <span class=\"n\">than</span> <span class=\"n\">exact</span> <span class=\"mi\">13896</span> <span class=\"n\">times</span>\n<span class=\"n\">exact</span> <span class=\"n\">is</span> <span class=\"n\">faster</span> <span class=\"n\">than</span> <span class=\"n\">refine</span> <span class=\"mi\">445</span> <span class=\"n\">times</span>\n<span class=\"n\">gain</span> <span class=\"n\">using</span> <span class=\"n\">refine</span><span class=\"o\">:</span> <span class=\"mi\">468050598</span>\n<span class=\"n\">gain</span> <span class=\"n\">using</span>  <span class=\"n\">exact</span><span class=\"o\">:</span> <span class=\"mi\">1320351</span>\n</code></pre></div>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/11936\">#11936</a> where I simply rename <code>exact</code> to <code>refine</code>: benchmarking says that it is slower!</p>\n<p>Why the difference?</p>",
        "id": 431663637,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1712401238
    },
    {
        "content": "<p>Your initial numbers don't seem correctly measured to me.</p>\n<p>here they are basically always the same:<br>\n<a href=\"/user_uploads/3121/u_fL9-f2CfkTZiiyPwe3SdR-/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/u_fL9-f2CfkTZiiyPwe3SdR-/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/u_fL9-f2CfkTZiiyPwe3SdR-/image.png\"></a></div><p>and then in overhleming refine victories like here:<br>\n<a href=\"/user_uploads/3121/CzlTzGFl53qjZVnvZP60m61k/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/CzlTzGFl53qjZVnvZP60m61k/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/CzlTzGFl53qjZVnvZP60m61k/image.png\"></a></div><p>the proof doesn't seem to pass at all?</p>",
        "id": 431664238,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1712401842
    },
    {
        "content": "<p>Ah, you are right: the second one that is run among <code>exact</code> and <code>refine</code> is consistently (a tiny amount) faster than the first one!</p>",
        "id": 431692925,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1712426626
    }
]