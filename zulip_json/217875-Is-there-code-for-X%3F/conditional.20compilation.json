[
    {
        "content": "<p>I have a lean executable (the <code>loogle</code> CLI) that I want to be able to compile with or (by default) without seccomp support. Seccomp support entails</p>\n<ul>\n<li>In <a href=\"https://github.com/nomeata/loogle/blob/master/lakefile.lean\">the <code>lakefile.lean</code></a> a <code>target</code>, an <code>extern_lib</code> and a <code>lean_lib</code></li>\n<li>In <a href=\"https://github.com/nomeata/loogle/blob/master/Loogle.lean\">the main <code>Loogle.lean</code></a> one <code>import</code> and one line of code invoking it.<br>\nBy default, a user running <code>lake build</code> should see neither of these, but <code>lake build -KSeccomp</code> or something like this should work as it should.</li>\n</ul>\n<p>I guess inside the <code>lakefile.lean</code> I can work with <code>meta if</code>, but how do I go about making the import and the <code>Seccomp.enable</code> line in <code>Loogle.lean</code> conditional?</p>",
        "id": 410309852,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1703777703
    },
    {
        "content": "<p>I gave it a shot on my own, and hacked something up by querying the environment variables  in the lakefile and the actual code. Seems to workâ€¦ <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>  (<a href=\"https://github.com/nomeata/loogle/commit/b1751fc63f009f809ee7d7ab4b475b7284ffd395\">https://github.com/nomeata/loogle/commit/b1751fc63f009f809ee7d7ab4b475b7284ffd395</a>)</p>",
        "id": 411054124,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1704304118
    }
]