[
    {
        "content": "<p>Aesop.buildGlobalRule now needs a Context since it runs inside Aesop.ElabM.  The Context has<code>goal : MVarId</code>.  I was calling <code>buildGlobalRule</code> in an attribute handler to make global rules, and thus not inside a proof where there are goals.  Is there an appropriate fake goal to use?</p>",
        "id": 424610458,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1709544382
    },
    {
        "content": "<p>If buildGlobalRule fundamentally needs the goal, what does it do with it?</p>",
        "id": 424610642,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1709544439
    },
    {
        "content": "<p>The code I have to update: <a href=\"https://github.com/leanprover-community/mathlib4/pull/10562/files#diff-c70f7019794a20f5fc3a6bae8b84b29c08832b54b3de126ef0ee5e5a43ad2b02R90\">https://github.com/leanprover-community/mathlib4/pull/10562/files#diff-c70f7019794a20f5fc3a6bae8b84b29c08832b54b3de126ef0ee5e5a43ad2b02R90</a></p>",
        "id": 424610766,
        "sender_full_name": "Geoffrey Irving",
        "timestamp": 1709544481
    },
    {
        "content": "<p>Sorry about that; it's a hack to work around some limitations of the Lean API. You can use <a href=\"https://github.com/leanprover-community/aesop/blob/c51fa8ea4de8b203f64929cba19d139e555f9f6b/Aesop/ElabM.lean#L26\"><code>ElabM.Context.forAdditionalGlobalRules</code></a> like <a href=\"https://github.com/leanprover-community/aesop/blob/c51fa8ea4de8b203f64929cba19d139e555f9f6b/Aesop/Frontend/Attribute.lean#L32\">here</a>.</p>",
        "id": 424666611,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1709562348
    }
]