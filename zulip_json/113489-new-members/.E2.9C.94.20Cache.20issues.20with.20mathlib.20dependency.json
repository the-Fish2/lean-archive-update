[
    {
        "content": "<p>I am having trouble with my mathlib dependency. Mathlib is failing to build. </p>\n<p>My lean-toolchain:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4.6.0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n</code></pre></div>\n<p>My lake-file.lean:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"n\">Lake</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">Lake</span> <span class=\"n\">DSL</span>\n\n<span class=\"n\">package</span> <span class=\"n\">crn</span>\n\n<span class=\"n\">lean_lib</span> <span class=\"n\">CRN</span>\n\n<span class=\"n\">require</span> <span class=\"n\">std</span> <span class=\"k\">from</span> <span class=\"n\">git</span>\n  <span class=\"s2\">\"https://github.com/leanprover/std4/\"</span> <span class=\"bp\">@</span> <span class=\"s2\">\"main\"</span>\n\n<span class=\"n\">require</span> <span class=\"n\">mathlib</span> <span class=\"k\">from</span> <span class=\"n\">git</span>\n  <span class=\"s2\">\"https://github.com/leanprover-community/mathlib4.git\"</span> <span class=\"bp\">@</span> <span class=\"s2\">\"master\"</span>\n\n<span class=\"n\">require</span> <span class=\"n\">aesop</span> <span class=\"k\">from</span> <span class=\"n\">git</span> <span class=\"s2\">\"https://github.com/JLimperg/aesop\"</span> <span class=\"bp\">@</span> <span class=\"s2\">\"master\"</span>\n</code></pre></div>\n<p>When I try to run lake build or lake update, it tells me that my local mathlib has diverged. I am only importing mathlib as a dependency, so I don't think this should be true. I have tried deleting lake-manifest.json and .lake, and then building, but I get the same issue. </p>\n<p>It also tells me that there are files missing from my cache. When I run lake exe cache get!, it attempts to download 4000 files, and only successfully downloads 400 or so. It frequently tells me that the connection has been interrupted by peer.</p>\n<p>I have seen posts from people with similar issues, and I have tried to follow the recommended solutions, but I must be misunderstanding something, because despite several hours of messing around with things, I have never gotten it to work.</p>\n<p>My whole project was working last week, and I don't remember changing anything before it broke.</p>",
        "id": 422138316,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708298833
    },
    {
        "content": "<p>I wish I could give more useful information, but I have tried so many things by now that I have lost any sense of what is relevant. I am hoping that I am missing something obvious, or that one of you will be able to ask the right questions to point me towards the issue.</p>",
        "id": 422138490,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708299011
    },
    {
        "content": "<p>You almost never want to put std and Aesop in your lakefile</p>",
        "id": 422139960,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708300540
    },
    {
        "content": "<p>That means \"I don't want to use the versions of these package that mathlib is using, I want to be in control of the versions myself\"</p>",
        "id": 422140020,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708300576
    },
    {
        "content": "<p>... which means unless by coincidence you have exactly the right version, the cache will not work for you at all</p>",
        "id": 422140041,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708300608
    },
    {
        "content": "<p>Ah ok, thank you. Is there documentation on the lake-file somewhere? I was looking for it, but I couldn't find it. I didn't realize I was already getting those from mathlib.</p>",
        "id": 422140258,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708300823
    },
    {
        "content": "<p>Ill give that a try and see where I get.</p>",
        "id": 422140282,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708300837
    },
    {
        "content": "<p>If I delete my .lake and lake-manifest, what is the correct thing to do next. lake build?</p>",
        "id": 422140406,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708300925
    },
    {
        "content": "<p>That fixed it, glad it was something so dumb!</p>",
        "id": 422141064,
        "sender_full_name": "Jesse Slater",
        "timestamp": 1708301496
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"575564\">Jesse Slater</span> has marked this topic as resolved.</p>",
        "id": 422141069,
        "sender_full_name": "Notification Bot",
        "timestamp": 1708301504
    }
]