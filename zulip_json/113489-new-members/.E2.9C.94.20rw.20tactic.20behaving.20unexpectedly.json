[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">foo</span> <span class=\"o\">(</span><span class=\"n\">n</span> <span class=\"o\">:</span> <span class=\"n\">Nat</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">n</span> <span class=\"bp\">+</span> <span class=\"mi\">7</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">bar</span> <span class=\"o\">:</span> <span class=\"n\">foo</span> <span class=\"n\">n</span> <span class=\"bp\">=</span> <span class=\"n\">foo</span> <span class=\"n\">m</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span>\n  <span class=\"n\">rw</span> <span class=\"o\">(</span><span class=\"n\">config</span> <span class=\"o\">:=</span> <span class=\"o\">{</span><span class=\"n\">occs</span> <span class=\"o\">:=</span> <span class=\"bp\">.</span><span class=\"n\">pos</span> <span class=\"o\">[</span><span class=\"mi\">2</span><span class=\"o\">]})</span> <span class=\"o\">[</span><span class=\"n\">foo</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>I expected that the goal would now be <code>foo n = m + 7</code>, but I instead get <code>failed to rewrite using equation theorems for 'foo'</code>.</p>\n<p>If I change the 2 to a 1 then the goal becomes <code>n + 7 = foo m</code> as expected.</p>\n<p>Writing simply <code>rw [foo m]</code> doesn't seem to work around.</p>\n<p>This looks like an identical issue to <a href=\"https://github.com/leanprover/lean4/issues/2538\">https://github.com/leanprover/lean4/issues/2538</a>. However the PR to fix that was merged a month ago, and I am using a recent version of Lean:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">&gt;</span> <span class=\"n\">lean.exe</span> <span class=\"c1\">--version</span>\n<span class=\"n\">Lean</span> <span class=\"o\">(</span><span class=\"n\">version</span> <span class=\"mi\">4</span><span class=\"bp\">.</span><span class=\"mi\">5</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"o\">,</span> <span class=\"n\">commit</span> <span class=\"mi\">1</span><span class=\"n\">a3021f98e55</span><span class=\"o\">,</span> <span class=\"n\">Release</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Any ideas?</p>",
        "id": 420926865,
        "sender_full_name": "Preeyan Parmar",
        "timestamp": 1707690318
    },
    {
        "content": "<p>This works without issue in Lean 4 Web</p>",
        "id": 421252193,
        "sender_full_name": "Mark Fischer",
        "timestamp": 1707833979
    },
    {
        "content": "<p>If you navigate to the merged commit, it will list all versions it is included in <a href=\"https://github.com/leanprover/lean4/commit/504b6dc93f46785ccddb8c5ff4a8df5be513d887\">https://github.com/leanprover/lean4/commit/504b6dc93f46785ccddb8c5ff4a8df5be513d887</a></p>",
        "id": 421252782,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1707834161
    },
    {
        "content": "<p>Right! So the fix is only in 4.6.0-rc1.</p>\n<p>(I looked at the date of the commit 1a3021f98e55, and it was recent. But it's actually a recent commit to a release branch.)</p>",
        "id": 421261587,
        "sender_full_name": "Preeyan Parmar",
        "timestamp": 1707836593
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306502\">Preeyan Parmar</span> has marked this topic as resolved.</p>",
        "id": 421261611,
        "sender_full_name": "Notification Bot",
        "timestamp": 1707836600
    }
]