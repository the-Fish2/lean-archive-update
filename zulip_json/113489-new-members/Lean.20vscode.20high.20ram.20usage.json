[
    {
        "content": "<p>I have installed Lean 3.51.1 along with the Lean3 vscode extension which I need for a university module.  I cannot seem to get mathlib working. I have attempted multiple fresh installs and ran leanproject new, however during the installation it ends with an error: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">%</span> <span class=\"n\">leanproject</span> <span class=\"n\">new</span> <span class=\"n\">leanFolder</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">cd</span> <span class=\"n\">leanFolder</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">init</span> <span class=\"bp\">-</span><span class=\"n\">q</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"bp\">-</span><span class=\"n\">b</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">51</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">Switched</span> <span class=\"n\">to</span> <span class=\"n\">a</span> <span class=\"n\">new</span> <span class=\"n\">branch</span> <span class=\"bp\">'</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"mi\">3</span><span class=\"bp\">.</span><span class=\"mi\">51</span><span class=\"bp\">.</span><span class=\"mi\">1</span><span class=\"bp\">'</span>\n<span class=\"n\">configuring</span> <span class=\"n\">leanFolder</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">Adding</span> <span class=\"n\">mathlib</span>\n<span class=\"n\">mathlib</span><span class=\"o\">:</span> <span class=\"n\">cloning</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">to</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">github.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">community</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span>\n<span class=\"n\">Cloning</span> <span class=\"n\">into</span> <span class=\"bp\">'</span><span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib'...</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Enumerating</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">387724</span><span class=\"o\">,</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Counting</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">3642</span><span class=\"bp\">/</span><span class=\"mi\">3642</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Compressing</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">1038</span><span class=\"bp\">/</span><span class=\"mi\">1038</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"n\">remote</span><span class=\"o\">:</span> <span class=\"n\">Total</span> <span class=\"mi\">387724</span> <span class=\"o\">(</span><span class=\"n\">delta</span> <span class=\"mi\">3289</span><span class=\"o\">),</span> <span class=\"n\">reused</span> <span class=\"mi\">2687</span> <span class=\"o\">(</span><span class=\"n\">delta</span> <span class=\"mi\">2602</span><span class=\"o\">),</span> <span class=\"n\">pack</span><span class=\"bp\">-</span><span class=\"n\">reused</span> <span class=\"mi\">384082</span>\n<span class=\"n\">Receiving</span> <span class=\"n\">objects</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">387724</span><span class=\"bp\">/</span><span class=\"mi\">387724</span><span class=\"o\">),</span> <span class=\"mi\">218</span><span class=\"bp\">.</span><span class=\"mi\">51</span> <span class=\"n\">MiB</span> <span class=\"bp\">|</span> <span class=\"mi\">9</span><span class=\"bp\">.</span><span class=\"mi\">95</span> <span class=\"n\">MiB</span><span class=\"bp\">/</span><span class=\"n\">s</span><span class=\"o\">,</span> <span class=\"n\">done.</span>\n<span class=\"n\">Resolving</span> <span class=\"n\">deltas</span><span class=\"o\">:</span> <span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"o\">(</span><span class=\"mi\">310642</span><span class=\"bp\">/</span><span class=\"mi\">310642</span><span class=\"o\">),</span> <span class=\"n\">done.</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"c1\">--detach 4e976107aa81b41822bd5bb2b15c90b1c8a2aa15    # in directory _target/deps/mathlib</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">4</span><span class=\"n\">e976107aa</span> <span class=\"n\">feat</span><span class=\"o\">(</span><span class=\"n\">measure_theory</span><span class=\"bp\">/</span><span class=\"n\">order</span><span class=\"bp\">/</span><span class=\"n\">upper_lower</span><span class=\"o\">):</span> <span class=\"n\">Order</span><span class=\"bp\">-</span><span class=\"n\">connected</span> <span class=\"n\">sets</span> <span class=\"k\">in</span> <span class=\"bp\">`</span><span class=\"n\">ℝⁿ</span><span class=\"bp\">`</span> <span class=\"n\">are</span> <span class=\"n\">measurable</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"mi\">16976</span><span class=\"o\">)</span>\n<span class=\"n\">configuring</span> <span class=\"n\">leanFolder</span> <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">1</span>\n<span class=\"n\">mathlib</span><span class=\"o\">:</span> <span class=\"n\">trying</span> <span class=\"n\">to</span> <span class=\"n\">update</span> <span class=\"n\">_target</span><span class=\"bp\">/</span><span class=\"n\">deps</span><span class=\"bp\">/</span><span class=\"n\">mathlib</span> <span class=\"n\">to</span> <span class=\"n\">revision</span> <span class=\"mi\">4</span><span class=\"n\">e976107aa81b41822bd5bb2b15c90b1c8a2aa15</span>\n<span class=\"bp\">&gt;</span> <span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"c1\">--detach 4e976107aa81b41822bd5bb2b15c90b1c8a2aa15    # in directory _target/deps/mathlib</span>\n<span class=\"n\">HEAD</span> <span class=\"n\">is</span> <span class=\"n\">now</span> <span class=\"n\">at</span> <span class=\"mi\">4</span><span class=\"n\">e976107aa</span> <span class=\"n\">feat</span><span class=\"o\">(</span><span class=\"n\">measure_theory</span><span class=\"bp\">/</span><span class=\"n\">order</span><span class=\"bp\">/</span><span class=\"n\">upper_lower</span><span class=\"o\">):</span> <span class=\"n\">Order</span><span class=\"bp\">-</span><span class=\"n\">connected</span> <span class=\"n\">sets</span> <span class=\"k\">in</span> <span class=\"bp\">`</span><span class=\"n\">ℝⁿ</span><span class=\"bp\">`</span> <span class=\"n\">are</span> <span class=\"n\">measurable</span> <span class=\"o\">(</span><span class=\"bp\">#</span><span class=\"mi\">16976</span><span class=\"o\">)</span>\n<span class=\"n\">Looking</span> <span class=\"n\">for</span> <span class=\"n\">mathlib</span> <span class=\"n\">oleans</span> <span class=\"n\">for</span> <span class=\"mi\">4</span><span class=\"n\">e976107aa</span>\n  <span class=\"n\">locally...</span>\n  <span class=\"n\">remotely...</span>\n<span class=\"n\">HTTPSConnectionPool</span><span class=\"o\">(</span><span class=\"n\">host</span><span class=\"bp\">='</span><span class=\"n\">oleanstorage.azureedge.net'</span><span class=\"o\">,</span> <span class=\"n\">port</span><span class=\"bp\">=</span><span class=\"mi\">443</span><span class=\"o\">):</span> <span class=\"n\">Max</span> <span class=\"n\">retries</span> <span class=\"n\">exceeded</span> <span class=\"k\">with</span> <span class=\"n\">url</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"n\">e976107aa81b41822bd5bb2b15c90b1c8a2aa15.tar.xz</span> <span class=\"o\">(</span><span class=\"n\">Caused</span> <span class=\"kd\">by</span> <span class=\"n\">NameResolutionError</span><span class=\"o\">(</span><span class=\"s2\">\"&lt;urllib3.connection.HTTPSConnection object at 0x103065450&gt;: Failed to resolve 'oleanstorage.azureedge.net' ([Errno 8] nodename nor servname provided, or not known)\"</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>From here if i attempt to use 'import tactic' anywhere within a lean file, my system becomes more unresponsive and RAM usage becomes very high. I'm assuming it has something to do with not being able to get the mathlib olean files? Any help would be appreciated, I am on MacOS Sonoma and used homebrew to install lean3</p>",
        "id": 411229325,
        "sender_full_name": "bradley",
        "timestamp": 1704388588
    },
    {
        "content": "<p>Yes, it has to do with the error fetching oleans. There has been some cloud issues with the cache servers recently, and I am not 100% sure the olean cache server for mathlib3 will come back given that everyone has migrated to Lean 4 (it probably will, though).</p>",
        "id": 411231709,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704389547
    },
    {
        "content": "<p>Is there any chance you can convince your professor to migrate to Lean 4 in a future version of the course?</p>",
        "id": 411231765,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704389574
    },
    {
        "content": "<p>It has been acknowledged, but as with most courses things take a long time to get moving unfortunately :(<br>\nIs there any other way to retrieve the oleans for now? Or just wait and hope it comes up eventually?</p>",
        "id": 411232004,
        "sender_full_name": "bradley",
        "timestamp": 1704389687
    },
    {
        "content": "<p>The nice thing about Lean 3 oleans is that they're distributed in a single zip file, so the mathlib <span class=\"user-group-mention\" data-user-group-id=\"2494\">@maintainers</span> can probably just upload the cache corresponding to mathlib3 master somewhere.</p>",
        "id": 411232232,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704389773
    },
    {
        "content": "<p>It should be back already</p>",
        "id": 411232339,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704389821
    },
    {
        "content": "<p>note that mathlib3 cache is tested daily as part of mathport CI</p>",
        "id": 411232621,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704389942
    },
    {
        "content": "<p>The server? If so I just tried again and was met with the same error: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">Looking</span> <span class=\"n\">for</span> <span class=\"n\">mathlib</span> <span class=\"n\">oleans</span> <span class=\"n\">for</span> <span class=\"mi\">4</span><span class=\"n\">e976107aa</span>\n  <span class=\"n\">locally...</span>\n  <span class=\"n\">remotely...</span>\n<span class=\"n\">HTTPSConnectionPool</span><span class=\"o\">(</span><span class=\"n\">host</span><span class=\"bp\">='</span><span class=\"n\">oleanstorage.azureedge.net'</span><span class=\"o\">,</span> <span class=\"n\">port</span><span class=\"bp\">=</span><span class=\"mi\">443</span><span class=\"o\">):</span> <span class=\"n\">Max</span> <span class=\"n\">retries</span> <span class=\"n\">exceeded</span> <span class=\"k\">with</span> <span class=\"n\">url</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">mathlib</span><span class=\"bp\">/</span><span class=\"mi\">4</span><span class=\"n\">e976107aa81b41822bd5bb2b15c90b1c8a2aa15.tar.xz</span> <span class=\"o\">(</span><span class=\"n\">Caused</span> <span class=\"kd\">by</span> <span class=\"n\">NameResolutionError</span><span class=\"o\">(</span><span class=\"s2\">\"&lt;urllib3.connection.HTTPSConnection object at 0x104abd350&gt;: Failed to resolve 'oleanstorage.azureedge.net' ([Errno 8] nodename nor servname provided, or not known)\"</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 411232644,
        "sender_full_name": "bradley",
        "timestamp": 1704389949
    },
    {
        "content": "<p>I believe that is the error I've always had, even from first attempt at running, I'll try again a bit later. <br>\nI'm also trying on Linux but i cant seem to install a lean version through elan, I assume because its deprecated</p>",
        "id": 411233133,
        "sender_full_name": "bradley",
        "timestamp": 1704390131
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean.20vscode.20high.20ram.20usage/near/411232621\">said</a>:</p>\n<blockquote>\n<p>note that mathlib3 cache is tested daily as part of mathport CI</p>\n</blockquote>\n<p>Wasn't this disabled in <a href=\"https://github.com/leanprover-community/mathport/pull/245\">mathport#245</a>?</p>",
        "id": 411234095,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704390519
    },
    {
        "content": "<p>that's a good point, it is a bit concerning because we do rely on the cache for usage of the tool by end users</p>",
        "id": 411236718,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704391588
    },
    {
        "content": "<p>I'm having this problem at the moment too. I've edited some files in one of my mathlib3 projects and am unable to get the cache and docs for it. No clue what to do.</p>\n<p>Obviously am porting to Lean4, but I need to also have this running too.</p>",
        "id": 411397059,
        "sender_full_name": "Monica Omar",
        "timestamp": 1704472263
    },
    {
        "content": "<p>Try running <code>leanproject -u \"https://oleanstorage.blob.core.windows.net/mathlib/\" get-mathlib-cache</code> manually</p>",
        "id": 411399675,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704473416
    },
    {
        "content": "<p>(leanproject currently points to <code>https://oleanstorage.azureedge.net/mathlib/</code> which doesn't work)</p>",
        "id": 411399767,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704473461
    },
    {
        "content": "<p>It should be back on now</p>",
        "id": 411399838,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1704473497
    },
    {
        "content": "<p>Now <code>oleanstorage.azureedge.net</code> resolves but leanproject doesn't find any caches with the default URL (<code>https://oleanstorage.blob.core.windows.net/mathlib/</code> instead of <code>https://oleanstorage.azureedge.net/mathlib/</code> still works)</p>",
        "id": 411400277,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704473662
    },
    {
        "content": "<p>Working now, thanks! It sometimes takes a few tries, though, I guess some change is propagating.</p>",
        "id": 411400665,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1704473823
    }
]