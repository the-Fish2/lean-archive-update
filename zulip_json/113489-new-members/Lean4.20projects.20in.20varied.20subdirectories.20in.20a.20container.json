[
    {
        "content": "<p>We want to (1) have Lean4 projects, as created using <em>lake new</em>, in subdirectories scattered across a larger codebase, and (2) use VSCode with remote containers as an IDE. It doesn't work. The problem is that imports are broken, not for lean but for lean4-vscode. If I use \"lake new\" to create a new Lean project somewhere in the directory structure of a larger project  the imports fail.  Lake build works, but the VSCode extension doesn't.  To see for yourself, use lake new to create a project somewhere other than at the top level project directory. Then open the generated Main.lean code. VSCode will report that the package isn't known.  I'm a bit  pessimistic about short-term, easy fixes, but am hoping for an upside surprise.</p>",
        "id": 444615111,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718341096
    },
    {
        "content": "<p>To clarify one thing.  The \"lake build\" command builds a binary, so for the \"compiler,\" the imports are working. But the Lean4 VSCode plugin (or language server?)  states that the module name is unknown, with a red squiggly underline with a tooltip to communicate the point. The Lean server then gives up, as reported by VSCode, making VSCode editing of Lean components not so useful (?) in this kind of case.</p>",
        "id": 444617109,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718342079
    },
    {
        "content": "<p>I am not sure that I follow what the issue is, but it looks like <a href=\"#narrow/stream/270676-lean4/topic/Support.20for.20multi-toolchain.20workspaces\">this thread</a> may be relevant?</p>",
        "id": 444630252,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1718347447
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444630252\">said</a>:</p>\n<blockquote>\n<p>I am not sure that I follow what the issue is, but it looks like <a href=\"#narrow/stream/270676-lean4/topic/Support.20for.20multi-toolchain.20workspaces\">this thread</a> may be relevant?</p>\n</blockquote>\n<p>Thank you. The work reported there appears to allow different toolchains to be used for different, and for nested, packages. It's close, but doesn't address the problem of the broken importing function in lean4-vscode.</p>",
        "id": 444714698,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718375995
    },
    {
        "content": "<p>When you mention creating a project inside of the \"top level project directory\", are both of those projects Lean projects? (I.e. do they both contain a <code>lean-toolchain</code> file)?</p>",
        "id": 444719609,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718377449
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444719609\">said</a>:</p>\n<blockquote>\n<p>When you mention creating a project inside of the \"top level project directory\", are both of those projects Lean projects? (I.e. do they both contain a <code>lean-toolchain</code> file)?</p>\n</blockquote>\n<p>Here are simple instructions to reproduce.</p>\n<p>Somewhere on your file system do this:</p>\n<p>mkdir foo<br>\ncd foo<br>\nmkdir bar<br>\ncd bar<br>\nlake init<br>\ncd ..<br>\ncode .</p>\n<p>Now open bar/Main.lean</p>",
        "id": 444720909,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718377788
    },
    {
        "content": "<p>This works perfectly fine on my end. What's your Lean 4 VS Code extension version?</p>",
        "id": 444721496,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718377957
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444721496\">said</a>:</p>\n<blockquote>\n<p>This works perfectly fine on my end. What's your Lean 4 VS Code extension version?</p>\n</blockquote>\n<p>v0.0.95<br>\n<a href=\"/user_uploads/3121/rNdI7LR6CUlT4XlzkC8fP4__/lean4-vscode_screen.jpg\">lean4-vscode_screen.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/rNdI7LR6CUlT4XlzkC8fP4__/lean4-vscode_screen.jpg\" title=\"lean4-vscode_screen.jpg\"><img src=\"/user_uploads/3121/rNdI7LR6CUlT4XlzkC8fP4__/lean4-vscode_screen.jpg\"></a></div>",
        "id": 444722086,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718378134
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"124175\">Kevin Sullivan</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444722086\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444721496\">said</a>:</p>\n<blockquote>\n<p>This works perfectly fine on my end. What's your Lean 4 VS Code extension version?</p>\n</blockquote>\n<p>v0.0.95</p>\n</blockquote>\n<p>The current version is v0.0.160. How did you even get stuck with such an old version? 0.0.95 is from Aug 30, 2022.</p>",
        "id": 444722384,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718378217
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444722384\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"124175\">Kevin Sullivan</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444722086\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444721496\">said</a>:</p>\n<blockquote>\n<p>This works perfectly fine on my end. What's your Lean 4 VS Code extension version?</p>\n</blockquote>\n<p>v0.0.95</p>\n</blockquote>\n<p>The current version is v0.0.160. How did you even get stuck with such an old version? 0.0.95 is from Aug 30, 2022.</p>\n</blockquote>\n<p>Yikes, it's what's in the extensions repo, as far as I can tell! Screen grab attached.</p>\n<p><a href=\"/user_uploads/3121/b3n4_AUARadsrVt711SsqyRD/vscode2.jpg\">vscode2.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/b3n4_AUARadsrVt711SsqyRD/vscode2.jpg\" title=\"vscode2.jpg\"><img src=\"/user_uploads/3121/b3n4_AUARadsrVt711SsqyRD/vscode2.jpg\"></a></div>",
        "id": 444723220,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718378435
    },
    {
        "content": "<p>OK, looking at what happened in 0.0.96, I might have an idea for why you are stuck on such an old version: Your VS Code is probably severely outdated. In 0.0.96 the minimum VS Code version requirement of the extension was bumped to 1.70.0 from 1.61.0. Your VS Code version is probably somewhere between those and VS Code will not update extensions anymore if it does not fulfill the version requirement.</p>",
        "id": 444723558,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718378526
    },
    {
        "content": "<p>By the way, the current minimum VS Code version requirement is 1.75.0 (from January 2023).</p>",
        "id": 444723943,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718378643
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444723558\">said</a>:</p>\n<blockquote>\n<p>OK, looking at what happened in 0.0.96, I might have an idea for why you are stuck on such an old version: Your VS Code is probably severely outdated. In 0.0.96 the minimum VS Code version requirement of the extension was bumped to 1.70.0 from 1.61.0. Your VS Code version is probably somewhere between those and VS Code will not update extensions anymore if it does not fulfill the version requirement.</p>\n</blockquote>\n<p>Oh jeez. April 2022 (version 1.67). Yet it seems that I'm constantly accepting offers to update VSCode. I'll just nuke what I have installed and start over again. Thank you <em>very</em> much for this. Wasted multiple hours yesterday on this issue. I'll go give updating a try.</p>",
        "id": 444724146,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718378700
    },
    {
        "content": "<p>If you installed VS Code using a package manager, you may also need to update VS Code using the package manager. I really wish VS Code had informed you about either the fact that your Lean 4 extension version is outdated or that your VS Code updates are failing, though.</p>",
        "id": 444728245,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1718379813
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/stream/113489-new-members/topic/Lean4.20projects.20in.20varied.20subdirectories.20in.20a.20container/near/444728245\">said</a>:</p>\n<blockquote>\n<p>If you installed VS Code using a package manager, you may also need to update VS Code using the package manager. I really wish VS Code had informed you about either the fact that your Lean 4 extension version is outdated or that your VS Code updates are failing, though.</p>\n</blockquote>\n<p>Thank you, Marc. Updating VSCode worked as expected. Yeah, it was hair-pulling yesterday as I tried everything I could think of to get this all working. Computers!</p>",
        "id": 444728524,
        "sender_full_name": "Kevin Sullivan",
        "timestamp": 1718379894
    },
    {
        "content": "<p>Out of interest, what are all those funky lean extensions in vscode2.jpg and should I be installing them too?</p>",
        "id": 444782946,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1718396758
    }
]