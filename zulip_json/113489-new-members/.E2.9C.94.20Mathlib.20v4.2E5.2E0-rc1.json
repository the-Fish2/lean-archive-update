[
    {
        "content": "<p>i tried importing Mathlib but i could not make it work with my Lean Version...<br>\nmy Lean-toolchain version says: leanprover/lean4:v4.5.0-rc1<br>\nand in lakefile<br>\nrequire mathlib from git<br>\n  \"<a href=\"https://github.com/leanprover-community/mathlib4.git\">https://github.com/leanprover-community/mathlib4.git</a>\" @ \"v4.5.0-rc1\"</p>\n<p>do you maybe see an obvious mistake? building mathlib produces an error and \"lake update mathlib\" tells me that some files could not be downloaded nor be found in cache</p>",
        "id": 421491771,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707930475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684702\">Simon Daniel</span> has marked this topic as unresolved.</p>",
        "id": 421491984,
        "sender_full_name": "Notification Bot",
        "timestamp": 1707930524
    },
    {
        "content": "<p>2 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/stream/113489-new-members/topic/Proofs.20and.20Tactics\">#new members &gt; Proofs and Tactics</a> by <span class=\"user-mention silent\" data-user-id=\"684702\">Simon Daniel</span>.</p>",
        "id": 421500174,
        "sender_full_name": "Notification Bot",
        "timestamp": 1707933068
    },
    {
        "content": "<p>What error does building mathlib produce?</p>",
        "id": 421501567,
        "sender_full_name": "Mauricio Collares",
        "timestamp": 1707933493
    },
    {
        "content": "<p>lake update mathlib</p>\n<blockquote>\n<p>mathlib: running post-update hooks<br>\nAttempting to download 3842 file(s)<br>\nDownloaded: 0 file(s) [attempted 3842/3842 = 100%] (0% success)<br>\nWarning: some files were not found in the cache.<br>\nThis usually means that your local checkout of mathlib4 has diverged from upstream.<br>\nIf you push your commits to a branch of the mathlib4 repository, CI will build the oleans and they will be available later.<br>\nDecompressing 225 file(s)<br>\nunpacked in 143 ms</p>\n</blockquote>",
        "id": 421502141,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707933681
    },
    {
        "content": "<p>and this error shows up when importing mathlib: </p>\n<blockquote>\n<p>./.lake/packages/mathlib/././Mathlib/Lean/Meta.lean:22:4: error: 'Lean.MVarId.synthInstance' has already been declared<br>\n./.lake/packages/mathlib/././Mathlib/Lean/Meta.lean:26:4: error: 'Lean.MVarId.note' has already been declared<br>\nerror: external command <code>/home/simon/.elan/toolchains/leanprover--lean4---v4.5.0-rc1/bin/lean</code> exited with code 1</p>\n</blockquote>",
        "id": 421502567,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707933812
    },
    {
        "content": "<p>You should have a lake-manifest.json file in the root of your project, which should have an entry for mathlib with a commit hash. Does it start with 58eef79?</p>",
        "id": 421503662,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707934182
    },
    {
        "content": "<p>yes, it says \"rev\": 58eef79b1520d17ff085f58b599690c112a47e6b</p>",
        "id": 421508019,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707935784
    },
    {
        "content": "<p>Try removing the .lake folder in the root of your project</p>",
        "id": 421508372,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707935922
    },
    {
        "content": "<p>i did, same error<br>\nalso when running lake update the following gets printed a bunch of times:</p>\n<blockquote>\n<p>Failed to connect to <a href=\"http://lakecache.blob.core.windows.net\">lakecache.blob.core.windows.net</a> port 443 after 24 ms: Couldn't connect to server</p>\n</blockquote>",
        "id": 421509996,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707936483
    },
    {
        "content": "<p>I don't think there's any need for you to be running <code>lake update</code> at this point. You will need to try <code>lake exe cache get</code> until you can download everything, though</p>",
        "id": 421510705,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707936743
    },
    {
        "content": "<p>this results in </p>\n<blockquote>\n<p>Downloaded: 0 file(s) [attempted 3842/3842 = 100%] (0% success)<br>\nWarning: some files were not found in the cache.<br>\nThis usually means that your local checkout of mathlib4 has diverged from upstream.<br>\nIf you push your commits to a branch of the mathlib4 repository, CI will build the oleans and they will be available later</p>\n</blockquote>\n<p>does this mean that this Version Mathlib is no longer supported? I tried this on Tuesday aswell and had the 0% download success</p>",
        "id": 421513276,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707937671
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 421516409,
        "sender_full_name": "Richard Copley",
        "timestamp": 1707938747
    },
    {
        "content": "<p>No, Richard, that's not quite right</p>",
        "id": 421516520,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707938772
    },
    {
        "content": "<p>Uh oh! Sorry. (Deleted to avoid confusion.)</p>",
        "id": 421516556,
        "sender_full_name": "Richard Copley",
        "timestamp": 1707938787
    },
    {
        "content": "<p>Most likely this means that <span class=\"user-mention\" data-user-id=\"684702\">@Simon Daniel</span> touched some files within their local mathlib install (or that something else is messed up). In that case, <code>cache</code> tries to find the cache for the files as they appear on Simon's machine, and they appear nowhere else in the world so there is no cache found.</p>",
        "id": 421516861,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707938875
    },
    {
        "content": "<p>Ah, building mathlib, not a project that uses mathlib</p>",
        "id": 421516877,
        "sender_full_name": "Richard Copley",
        "timestamp": 1707938879
    },
    {
        "content": "<p>The other option is that we deleted the caches from the server because they're old. But 4.5.0-rc1 is last week material.</p>",
        "id": 421517054,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707938920
    },
    {
        "content": "<p>Here I would suggest to delete the <code>.lake</code> folder in your project and then run <code>lake exe cache get</code></p>",
        "id": 421517228,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707938972
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/113489-new-members/topic/Mathlib.20v4.2E5.2E0-rc1/near/421517228\">said</a>:</p>\n<blockquote>\n<p>Here I would suggest to delete the <code>.lake</code> folder in your project and then run <code>lake exe cache get</code></p>\n</blockquote>\n<p>i tried that multiple times <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 421517367,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707939012
    },
    {
        "content": "<p>Then your project configuration (combination of <code>lakefile</code>, <code>lean-toolchain</code> and <code>lae-manifest</code>) must be invalid. You can either share it with us or update to latest mathlib as Richard suggested in his deleted message.</p>",
        "id": 421517858,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707939186
    },
    {
        "content": "<p>Running <code>lake update</code> will have made changes to <code>lake-manifest.json</code>, meaning that lake will download different versions of the dependencies than the ones that the cache files were built with. You could try reverting the local changes to <code>lake-manifest.json</code>, then deleting <code>.lake</code>, then running <code>lake exe cache get</code> (and NOT <code>lake update</code>!)</p>",
        "id": 421517974,
        "sender_full_name": "Richard Copley",
        "timestamp": 1707939242
    },
    {
        "content": "<p>my project depends on( <a href=\"https://github.com/hargoniX/socket.lean\">https://github.com/hargoniX/socket.lean</a>) which sadly does not seem to compile using 4.6.0-rc (which works perfectly fine with mathlib)<br>\nif you know of a alternative for using sockets let me know...</p>",
        "id": 421519456,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707939811
    },
    {
        "content": "<p>lakefile</p>\n<blockquote>\n<p>import Lake<br>\nopen Lake DSL</p>\n<p>require socket from git<br>\n  \"<a href=\"https://github.com/hargoniX/socket.lean/\">https://github.com/hargoniX/socket.lean/</a>\" @ \"main\"</p>\n<p>require mathlib from git<br>\n  \"<a href=\"https://github.com/leanprover-community/mathlib4.git\">https://github.com/leanprover-community/mathlib4.git</a>\" @ \"v4.5.0-rc1\"</p>\n</blockquote>\n<p>lean-toolchain</p>\n<blockquote>\n<p>leanprover/lean4:v4.5.0-rc1</p>\n</blockquote>\n<p>manifest</p>\n<blockquote>\n<p>{\"version\": 7,<br>\n \"packagesDir\": \".lake/packages\",<br>\n \"packages\":<br>\n [{\"url\": \"<a href=\"https://github.com/tydeu/lean4-alloy/\">https://github.com/tydeu/lean4-alloy/</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"0a38fa20a1357d9d57e8cec54a33c6bbdc36efeb\",<br>\n   \"name\": \"alloy\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"master\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover/std4\">https://github.com/leanprover/std4</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"b1ebd72c5d262ea10a33ea582525925df874ad1e\",<br>\n   \"name\": \"std\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"main\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/hargoniX/socket.lean/\">https://github.com/hargoniX/socket.lean/</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"cf40f33eb09fd2bd9cd895551306b95bc17bcc67\",<br>\n   \"name\": \"socket\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"main\",<br>\n   \"inherited\": false,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover-community/quote4\">https://github.com/leanprover-community/quote4</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"ccba5d35d07a448fab14c0e391c8105df6e2564c\",<br>\n   \"name\": \"Qq\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"master\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover-community/aesop\">https://github.com/leanprover-community/aesop</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"69404390bdc1de946bf0a2e51b1a69f308e56d7a\",<br>\n   \"name\": \"aesop\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"master\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover-community/ProofWidgets4\">https://github.com/leanprover-community/ProofWidgets4</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"bf61e90de075abfa27f638922e7aafafdce77c44\",<br>\n   \"name\": \"proofwidgets\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"v0.0.24-pre2\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover/lean4-cli\">https://github.com/leanprover/lean4-cli</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"a751d21d4b68c999accb6fc5d960538af26ad5ec\",<br>\n   \"name\": \"Cli\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"main\",<br>\n   \"inherited\": true,<br>\n   \"configFile\": \"lakefile.lean\"},<br>\n  {\"url\": \"<a href=\"https://github.com/leanprover-community/mathlib4.git\">https://github.com/leanprover-community/mathlib4.git</a>\",<br>\n   \"type\": \"git\",<br>\n   \"subDir\": null,<br>\n   \"rev\": \"58eef79b1520d17ff085f58b599690c112a47e6b\",<br>\n   \"name\": \"mathlib\",<br>\n   \"manifestFile\": \"lake-manifest.json\",<br>\n   \"inputRev\": \"v4.5.0-rc1\",<br>\n   \"inherited\": false,<br>\n   \"configFile\": \"lakefile.lean\"}],<br>\n \"name\": \"default\",<br>\n \"lakeDir\": \".lake\"}</p>\n</blockquote>",
        "id": 421520100,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707940043
    },
    {
        "content": "<p>Oh, hmm. You seem to be depending on a Std version that matches the socket library, but not mathlib. That may be the issue</p>",
        "id": 421520572,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707940228
    },
    {
        "content": "<p>oh i guess that could only be fixed by the library maintainers?</p>",
        "id": 421527067,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707942490
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> ?</p>",
        "id": 421527111,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1707942512
    },
    {
        "content": "<p>Im busy right now but if you wanna send a PR with the correct version go ahead.</p>",
        "id": 421527441,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707942636
    },
    {
        "content": "<p>Is alloy up to date?</p>",
        "id": 421527487,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1707942653
    },
    {
        "content": "<p>It was updated semi recently by other PRs, no idea if its up to date up to date</p>",
        "id": 421527824,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707942778
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315577\">@Mac Malone</span> the most recent alloy master seems broken on 4.6 because of InfoTree changes, can you patch that?</p>",
        "id": 421529906,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707943628
    },
    {
        "content": "<p>It is patched already in <a href=\"https://github.com/tydeu/lean4-alloy/pull/7\">tydeu/lean4-alloy#7</a> modulo the toolchain name thanks to <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span></p>",
        "id": 421533386,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1707945014
    },
    {
        "content": "<p>And that's the only thing that is needed to bump sockets (ignoring depracation warnings)</p>",
        "id": 421533957,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1707945270
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> Done!</p>",
        "id": 421560936,
        "sender_full_name": "Mac Malone",
        "timestamp": 1707958982
    },
    {
        "content": "<p>(oops, had to force push because I accidently left some changes on a dev branch.)</p>",
        "id": 421561572,
        "sender_full_name": "Mac Malone",
        "timestamp": 1707959471
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/113489-new-members/topic/Mathlib.20v4.2E5.2E0-rc1/near/421517054\">said</a>:</p>\n<blockquote>\n<p>The other option is that we deleted the caches from the server because they're old. But 4.5.0-rc1 is last week material.</p>\n</blockquote>\n<p>Every commit on master and the tip of every branch is never garbage collected. Plus, the garbage collector for lean 4 hasn't been written yet <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 421572220,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1707966622
    },
    {
        "content": "<p>awesome, thanks alot, i also created a pull request on  socket.lean for the Version Bump</p>\n<p>for anyone interested in importing mathlib and Socket in your project: the require mathlib has to appear before the require socket one. Since both Libraries depend on a different version of std4 and mathlib will not compile with Sockets std version. Lake seems to choose the library version which appears first in the lakefile</p>\n<p>i guess this is the intended behavior?  or should lake differentiate between two libraries with same name but  different commit hash</p>",
        "id": 421595569,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707981952
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"684702\">@Simon Daniel</span> left a review</p>",
        "id": 421617555,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707990720
    },
    {
        "content": "<p>updated it, no more build warnings</p>",
        "id": 421633849,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707996640
    },
    {
        "content": "<p>Merged!</p>",
        "id": 421634264,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707996842
    },
    {
        "content": "<p>thanks, i'm using Sockets for my master thesis and the library has been very helpful to me</p>",
        "id": 421639311,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707998917
    },
    {
        "content": "<p>What are you doing with it?</p>",
        "id": 421639341,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707998931
    },
    {
        "content": "<p>something similar to this <a href=\"http://url\">https://github.com/gshen42/HasChor</a> <br>\na library to write distributed programs in Lean that get projected to different computing nodes and communicate with Socket.lean</p>",
        "id": 421640619,
        "sender_full_name": "Simon Daniel",
        "timestamp": 1707999406
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684702\">Simon Daniel</span> has marked this topic as resolved.</p>",
        "id": 421730564,
        "sender_full_name": "Notification Bot",
        "timestamp": 1708027154
    }
]