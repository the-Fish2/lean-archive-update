[
    {
        "content": "<p>Some terminals like alacritty, modifies LD_LIBRARY_PATH and running leanc directly will leads to problems like symbol lookup errors for clang. It took me an hour to trace this bug.</p>\n<p>I suggest it would be good to set LD_LIBRARY_PATH to empty for the leanc process and then run clang so that whatever LD_LIBRARY_PATH is set in the environment doesn't affect the compilation process.</p>",
        "id": 423331035,
        "sender_full_name": "Xiyu Zhai",
        "timestamp": 1708929220
    },
    {
        "content": "<p>You really should find out where LD_LIBRARY_PATH is set on your system, this is not normal and it's going to break much more than just Lean</p>",
        "id": 423348504,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1708937546
    },
    {
        "content": "<p>This behavior is caused by the alacritty distribution by snap on ubuntu. The snapcrafters change LD_LIBRARY_PATH to something that will cause leanc to throw out symbol lookup errors.</p>\n<p>In <code>https://github.com/snapcrafters/alacritty/blob/candidate/snap/snapcraft.yaml</code><br>\nthey set</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code>      <span class=\"n\">LD_LIBRARY_PATH</span><span class=\"o\">:</span> <span class=\"s2\">\"$SNAP/usr/lib/$CRAFT_ARCH_TRIPLET:$SNAP/lib/$CRAFT_ARCH_TRIPLET\"</span>\n</code></pre></div>\n<p>It's community maintained, so not so professional, lol.<br>\nI just put it here so that if anyone encounters similar problems by using leanc in alacritty, they will solve it faster.</p>",
        "id": 423436262,
        "sender_full_name": "Xiyu Zhai",
        "timestamp": 1708965371
    },
    {
        "content": "<p>I was curious since I am using alacritty, but not snap. On my system I have</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">~</span> <span class=\"bp\">$</span> <span class=\"n\">echo</span> <span class=\"bp\">$</span><span class=\"n\">LD_LIBRARY_PATH</span>\n<span class=\"bp\">/</span><span class=\"n\">etc</span><span class=\"bp\">/</span><span class=\"n\">sane</span><span class=\"bp\">-</span><span class=\"n\">libs</span>\n</code></pre></div>\n<p>It’s a big relieve to see that that only sane libs are using <code>LD_LIBRARY_PATH</code>, it seems…</p>",
        "id": 423491304,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1708984844
    },
    {
        "content": "<p>They just proposed a fix 2 hours ago.</p>",
        "id": 423491404,
        "sender_full_name": "Xiyu Zhai",
        "timestamp": 1708984886
    },
    {
        "content": "<p><a href=\"https://github.com/snapcrafters/alacritty/pull/14\">https://github.com/snapcrafters/alacritty/pull/14</a></p>",
        "id": 423491444,
        "sender_full_name": "Xiyu Zhai",
        "timestamp": 1708984905
    }
]