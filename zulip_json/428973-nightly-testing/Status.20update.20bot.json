[
    {
        "content": "<p>The <code>Update the nightly-testing-YYYY-MM-DD branch</code> fails (as far as I can tell) at the curl invocation if the tag doesn't exist yet:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">runner</span><span class=\"bp\">/</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">_temp</span><span class=\"bp\">/</span><span class=\"mi\">609</span><span class=\"n\">b384d</span><span class=\"bp\">-</span><span class=\"n\">ec77</span><span class=\"bp\">-</span><span class=\"mi\">4109</span><span class=\"bp\">-</span><span class=\"mi\">86</span><span class=\"n\">b3</span><span class=\"bp\">-</span><span class=\"mi\">6</span><span class=\"n\">dfb93bb97f1.sh</span><span class=\"o\">:</span> <span class=\"n\">line</span> <span class=\"mi\">14</span><span class=\"o\">:</span> <span class=\"bp\">***</span><span class=\"o\">:</span> <span class=\"n\">command</span> <span class=\"n\">not</span> <span class=\"n\">found</span>\n  <span class=\"bp\">%</span> <span class=\"n\">Total</span>    <span class=\"bp\">%</span> <span class=\"n\">Received</span> <span class=\"bp\">%</span> <span class=\"n\">Xferd</span>  <span class=\"n\">Average</span> <span class=\"n\">Speed</span>   <span class=\"n\">Time</span>    <span class=\"n\">Time</span>     <span class=\"n\">Time</span>  <span class=\"n\">Current</span>\n                                 <span class=\"n\">Dload</span>  <span class=\"n\">Upload</span>   <span class=\"n\">Total</span>   <span class=\"n\">Spent</span>    <span class=\"n\">Left</span>  <span class=\"n\">Speed</span>\n\n  <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>      <span class=\"mi\">0</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--     0</span>\n<span class=\"mi\">100</span>    <span class=\"mi\">52</span>  <span class=\"mi\">100</span>    <span class=\"mi\">52</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">148</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--   148</span>\n<span class=\"mi\">100</span>    <span class=\"mi\">52</span>  <span class=\"mi\">100</span>    <span class=\"mi\">52</span>    <span class=\"mi\">0</span>     <span class=\"mi\">0</span>    <span class=\"mi\">148</span>      <span class=\"mi\">0</span> <span class=\"c1\">--:--:-- --:--:-- --:--:--   148</span>\n<span class=\"n\">Creating</span> <span class=\"n\">tag</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">-</span><span class=\"mi\">2024</span><span class=\"bp\">-</span><span class=\"mi\">04</span><span class=\"bp\">-</span><span class=\"mi\">09</span> <span class=\"k\">from</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">state</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"n\">testing</span> <span class=\"n\">branch.</span><span class=\"o\">{</span><span class=\"s2\">\"code\"</span><span class=\"o\">:</span><span class=\"mi\">405</span><span class=\"o\">,</span><span class=\"s2\">\"message\"</span><span class=\"o\">:</span><span class=\"s2\">\"HTTP 405 Method Not Allowed\"</span><span class=\"o\">}</span>\n</code></pre></div>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/8615325483/job/23610624487\">https://github.com/leanprover-community/mathlib4/actions/runs/8615325483/job/23610624487</a></p>\n<p>and <code>Fetch lean-toolchain from latest bump branch</code> fails because the commit reference seems to be empty. <br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/8613013146/job/23603458087\">https://github.com/leanprover-community/mathlib4/actions/runs/8613013146/job/23603458087</a></p>\n<p>The first failure also blocks the zulip message</p>",
        "id": 432277836,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712677896
    },
    {
        "content": "<p>I tried to debug but realized this action uses the script from the master branch</p>",
        "id": 432277918,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712677920
    },
    {
        "content": "<p>One problem is probably a missing quote, it should be</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">curl</span> <span class=\"bp\">-</span><span class=\"n\">X</span> <span class=\"n\">POST</span> <span class=\"s2\">\"http://speed.lean-fro.org/mathlib4/api/commit/e7b27246-a3e6-496a-b552-ff4b45c7236e/$hash\"</span> <span class=\"bp\">-</span><span class=\"n\">u</span> <span class=\"s2\">\"admin:${{ secrets.SPEED }}\"</span>\n</code></pre></div>\n<p>as the secret contains characters worth escaping. Will put that into an (necessarily untested) PR at <a href=\"https://github.com/leanprover-community/mathlib4/pull/12038\">https://github.com/leanprover-community/mathlib4/pull/12038</a></p>",
        "id": 432317137,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1712688627
    },
    {
        "content": "<p>Do you want to merge it to hopefully unbreak the workflow, or are there more issues lurking?</p>",
        "id": 432506581,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1712756420
    },
    {
        "content": "<p>Huh, I thought I put it on the maintainer queue. Anyway, it's in bors's hands now</p>",
        "id": 432507411,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712756702
    },
    {
        "content": "<p>We'll see if it works in production :)</p>",
        "id": 432507436,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712756709
    },
    {
        "content": "<p>That's the spirit :-D</p>",
        "id": 432572381,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1712777641
    },
    {
        "content": "<p>I'm not always monitoring this, so feel free to ping me if more work is needed.</p>",
        "id": 432572414,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1712777643
    },
    {
        "content": "<p>(We'll only be able to see if it worked once the 2024-04-10 nightly is out)</p>",
        "id": 432579505,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712780744
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"470149\">Joachim Breitner</span> <a href=\"#narrow/stream/428973-nightly-testing/topic/Status.20update.20bot/near/432572414\">said</a>:</p>\n<blockquote>\n<p>I'm not always monitoring this, so feel free to ping me if more work is needed.</p>\n</blockquote>\n<p>Something has improved in <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/8645841052/job/23703844328\">https://github.com/leanprover-community/mathlib4/actions/runs/8645841052/job/23703844328</a> in that it's no longer marked as a failure (compare <a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/8615325483/job/23610624487\">https://github.com/leanprover-community/mathlib4/actions/runs/8615325483/job/23610624487</a>), but it still prints <code>{\"code\":405,\"message\":\"HTTP 405 Method Not Allowed\"}</code>. Any chance you can see why it's returning that?</p>",
        "id": 432701854,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712840764
    },
    {
        "content": "<p>Strange. With the wrong key, I get 401 Unauthorized. And with empty <code>$hash</code> I get 404. <br>\nAh, simply wrong URL. Should be <code>api/queue/commit</code>. Do you want to make that change, I am about to go.</p>",
        "id": 432713568,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1712844322
    },
    {
        "content": "<p>Ha, sure</p>",
        "id": 432714946,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712844698
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/428973-nightly-testing/topic/Status.20update.20bot/near/432277836\">said</a>:</p>\n<blockquote>\n<p>and <code>Fetch lean-toolchain from latest bump branch</code> fails because the commit reference seems to be empty. <br>\n<a href=\"https://github.com/leanprover-community/mathlib4/actions/runs/8613013146/job/23603458087\">https://github.com/leanprover-community/mathlib4/actions/runs/8613013146/job/23603458087</a></p>\n</blockquote>\n<p>I think this was caused by the bane of every careless github api user: pagination. <a href=\"https://github.com/leanprover-community/mathlib4/pull/12072\">#12072</a> up for review</p>",
        "id": 432781797,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712867111
    },
    {
        "content": "<p>Never make changes after testing your code or you look like a numpty. A review for <a href=\"https://github.com/leanprover-community/mathlib4/pull/12081\">#12081</a>, please?</p>",
        "id": 432861668,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712912322
    },
    {
        "content": "<p>AI generated code isn't replacing us yet: <a href=\"https://github.com/leanprover-community/mathlib4/pull/12085\">#12085</a></p>",
        "id": 432897954,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1712926532
    }
]