[
    {
        "content": "<p>I am interested in formalizing some enumerative combinatorics in Lean. That means that I am going to be doing some algebra in the ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">[</mo><mtext> ⁣</mtext><mo stretchy=\"false\">[</mo><mi>t</mi><mo stretchy=\"false\">]</mo><mtext> ⁣</mtext><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}[\\![t]\\!]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">[</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mclose\">]</span></span></span></span> of formal power series. However, I am also making an effort to state the lemmas that I need in as as general a setting as possible, rather than merely stating them for power series rings. So I have the following questions. I know very little about non-archimedean geometry, so please go easy on me if some of these questions are stupid.</p>\n<p>Let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> be a non-archimedean ring. By this I mean that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> is a topological ring and there is a neighborhood basis of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> consisting of open additive subgroups.</p>\n<ol>\n<li>Assume that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> is complete. If a sequence <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>a</mi><mi>n</mi></msub><msub><mo stretchy=\"false\">}</mo><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\{a_n\\}_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> of elements of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> tends to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> on the cofinite filter, does it follow that the product <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>∏</mo><mi>n</mi></msub><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\prod_{n} a_n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0497em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∏</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.0017em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> converges unconditionally?</li>\n<li>Is the topology on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> necessarily induced by an absolute value <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mo>⋅</mo><mi mathvariant=\"normal\">∣</mi><mspace></mspace><mspace width=\"0.1111em\"/><mo lspace=\"0em\" rspace=\"0.17em\"></mo><mtext> ⁣</mtext><mo lspace=\"0em\" rspace=\"0em\">:</mo><mspace width=\"0.3333em\"/><mi>R</mi><mo>→</mo><msub><mi mathvariant=\"double-struck\">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">|\\cdot| \\colon R \\to \\mathbb{R}_{\\geq 0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mspace nobreak\"></span><span class=\"mspace\" style=\"margin-right:0.1111em;\"></span><span class=\"mpunct\"></span><span class=\"mspace\" style=\"margin-right:-0.1667em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mrel\">:</span></span><span class=\"mspace\" style=\"margin-right:0.3333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9341em;vertical-align:-0.2452em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mrel mtight\">≥</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2452em;\"><span></span></span></span></span></span></span></span></span></span> which satisfies the ultrametric triangle inequality? (And if the answer is \"no\", is that just because <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}_{\\geq 0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9341em;vertical-align:-0.2452em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mrel mtight\">≥</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2452em;\"><span></span></span></span></span></span></span></span></span></span> isn't \"big enough\" and there's some other totally ordered commutative semigroup that would work?)</li>\n<li>Is there necessarily an open subring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>⊆</mo><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R&#x27; \\subseteq R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8879em;vertical-align:-0.136em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> such that there is a neighborhood basis of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> consisting of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">R&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>-submodules of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>?</li>\n</ol>",
        "id": 430349734,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711767058
    },
    {
        "content": "<p>Also, if the answer to any of these questions is \"no\", what is a reasonable extra assumption that I could add that would make the answer \"yes\"?</p>",
        "id": 430349844,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711767183
    },
    {
        "content": "<p>Also, just to be clear, a big part of the reason I am asking these questions is simply that I'm curious.</p>",
        "id": 430349941,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711767311
    },
    {
        "content": "<p>(3) is close to being a \"Huber ring\". See <a href=\"https://math.stanford.edu/~conrad/Perfseminar/Notes/L5.pdf\">https://math.stanford.edu/~conrad/Perfseminar/Notes/L5.pdf</a></p>",
        "id": 430356475,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1711773609
    },
    {
        "content": "<p>Thanks. It does seem that the first and the third of these properties hold for Huber rings. It is not clear to me whether the second one holds, but that one is probably the least important of the three for my purposes.</p>\n<p>I don't know if it'd make sense for me to formalize the theory of Huber rings just so I can take some infinite products of power series, but this is good to know about regardless.</p>\n<p>Are there any well-known examples of non-archimedean rings which are not Huber?</p>",
        "id": 430359473,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711776796
    },
    {
        "content": "<p>Is R assumed commutative?</p>",
        "id": 430364607,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1711781814
    },
    {
        "content": "<p>Yes</p>",
        "id": 430364619,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711781827
    },
    {
        "content": "<p>For 2 there's certainly examples where you need something bigger than NNReal (these might even be in mathlib) but I don't know any examples of nonarchimedean rings that aren't Huber so I'm not much help with these questions. I would imagine that if you have a norm to some totally ordered group with zero then the things of norm at most 1 give you 3.</p>",
        "id": 430365223,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1711782428
    },
    {
        "content": "<p>If you allow something bigger than NNReal, can you always do 2?</p>",
        "id": 430365351,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711782562
    },
    {
        "content": "<p>Maybe I should ask this on stackexchange</p>",
        "id": 430365460,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711782658
    },
    {
        "content": "<p>Let's assume that there's a nonarchimedean ring which isn't Huber (and this doesn't sound unreasonable, or else why would the notion of Huber exist). Then you won't be able to do 2 because I think 2 will imply Huber.</p>",
        "id": 430366316,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1711783574
    },
    {
        "content": "<p>I see. That isn't clear to me, but it sounds reasonable. I guess you would take the ideal to be everything with absolute value less than 1, then.</p>",
        "id": 430366771,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711784073
    },
    {
        "content": "<p>Oh I'd forgotten about the fg ideal assumption. In the rank 1 case you don't do this because it might not be fg (consider C_p, where you use I=(p) ). Basically we need a good example of an Archimedean ring which isn't Huber before we can get a good feeling for these questions.</p>",
        "id": 430367728,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1711785071
    },
    {
        "content": "<p>What about something like a Puiseux series ring? It seems like that wouldn't be Huber. But I think it still satisfies all the properties I asked about, unless I am making a mistake.</p>",
        "id": 430368358,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711785671
    },
    {
        "content": "<p>Oh, sorry, this is Huber</p>",
        "id": 430368971,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711786065
    },
    {
        "content": "<p>I was just not using my imagination enough when considering what the ideal could be</p>",
        "id": 430368994,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711786083
    },
    {
        "content": "<p>I'm not sure additive subgroups are enough. But ideals are. With <span class=\"user-mention\" data-user-id=\"406490\">@María Inés de Frutos Fernández</span> , we formalized “LinearTopology” to mean that, we should PR it relatively soon.</p>",
        "id": 430423309,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1711836432
    },
    {
        "content": "<p>We also define a topology on <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MvPowerSeries#doc\">docs#MvPowerSeries</a>. There is one obvious choice there, taking the product topology, given a topology on the ring of coefficients — possibly the discrete topology. In this case, this is a linear topology, complete and Hausdorff, and the polynomials are dense in it (see Bourbaki, Algebre, Chap. 4, §5). We use that to define evaluation of/substitutions within power series.</p>",
        "id": 430423453,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1711836577
    },
    {
        "content": "<p>Thanks; that should be very useful. I've been waiting for the power series compositions.</p>",
        "id": 430426144,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711839420
    },
    {
        "content": "<p>I know there are non-archimedean rings that are not linearly topologized; for example, any field. I guess my question comes down to \"Does every non-archimedean ring have a linearly topologized open subring?\"</p>",
        "id": 430426414,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711839707
    },
    {
        "content": "<p>Also, I think there are two different reasonable choices for the topology on a multivariate power series ring: the product topology and the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span>-adic topology, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>I</mi></mrow><annotation encoding=\"application/x-tex\">I</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span></span> is the ideal generated by the variables. These happen to be the same when there are finitely many variables, so maybe it doesn't matter too much.</p>",
        "id": 430426826,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1711840135
    },
    {
        "content": "<p>In general, the I-adic topology is poorly behaved.</p>",
        "id": 430496866,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1711909309
    }
]