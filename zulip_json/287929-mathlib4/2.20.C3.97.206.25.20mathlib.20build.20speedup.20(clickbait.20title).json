[
    {
        "content": "<p>I benchmarked two small changes to lean4 using the speedcenter, and both gave a 6% build time improvement:</p>\n<ul>\n<li><a href=\"http://speed.lean-fro.org/mathlib4/compare/d444b71b-0228-43f5-951d-975ddabbc565/to/77bd3441-1d67-4527-9a0c-188a17a83b8f\">http://speed.lean-fro.org/mathlib4/compare/d444b71b-0228-43f5-951d-975ddabbc565/to/77bd3441-1d67-4527-9a0c-188a17a83b8f</a></li>\n<li><a href=\"http://speed.lean-fro.org/mathlib4/compare/d444b71b-0228-43f5-951d-975ddabbc565/to/f1d3f7dd-931f-4250-9a10-263dbc927957\">http://speed.lean-fro.org/mathlib4/compare/d444b71b-0228-43f5-951d-975ddabbc565/to/f1d3f7dd-931f-4250-9a10-263dbc927957</a></li>\n</ul>\n<p>So if I merge them both, does that mean we’ll get ~12% improvement?…</p>\n<p>Unfortunately, this is too good to be true; the “instruction count” tells a different (and more plausible) story. It seems that this particular base line build took longer than usual, and now everything I do looks like an improvement. Oh well, it would have been so nice…</p>",
        "id": 435890810,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1714322999
    },
    {
        "content": "<p>Clearly that's wrong because you forgot how percentages work. The expected speedup is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mi mathvariant=\"normal\">%</mi><mo>−</mo><mn>94</mn><msup><mi mathvariant=\"normal\">%</mi><mn>2</mn></msup><mo>=</mo><mn>11.64</mn><mi mathvariant=\"normal\">%</mi></mrow><annotation encoding=\"application/x-tex\">100\\% - 94\\%^2 = 11.64\\%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100%</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8697em;vertical-align:-0.0556em;\"></span><span class=\"mord\">94</span><span class=\"mord\"><span class=\"mord\">%</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8056em;vertical-align:-0.0556em;\"></span><span class=\"mord\">11.64%</span></span></span></span> <span aria-label=\"grinning\" class=\"emoji emoji-1f600\" role=\"img\" title=\"grinning\">:grinning:</span></p>",
        "id": 435891470,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1714323647
    },
    {
        "content": "<p>I took this into account, accounted lazily , and wrote <code>~</code> for that reason :-)</p>",
        "id": 435891595,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1714323763
    },
    {
        "content": "<p>Also, if they improve independent code paths, the speedup will even be more than 12%!</p>",
        "id": 435891633,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1714323808
    }
]