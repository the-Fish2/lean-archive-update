[
    {
        "content": "<p>I recently merged a PR adding GroupTheory/Submonoid/Units.lean. Unfortunately the documentation does not look as expected.</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Submonoid.units#doc\">docs#Submonoid.units</a></p>\n<p>In particular:<br>\na) the Markdown table has not rendered as expected (despite rendering fine in separate markdown files)<br>\nb) I feel as if the \"to_additives\" have added a lot of extraneous proofs which, apart from anything else, make the page quite hard to read.</p>\n<p>I want to address both of these but I don't know how. Any help?</p>",
        "id": 421527143,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707942525
    },
    {
        "content": "<p>What on earth is going on with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddSubmonoid.ofAddUnits_addUnits_le.match_1#doc\">docs#AddSubmonoid.ofAddUnits_addUnits_le.match_1</a>, for instance?</p>",
        "id": 421527542,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707942672
    },
    {
        "content": "<p>Markdown tables have different syntax depending on the parser. I can't remember which one we use, but that's my best guess without really diving in.</p>",
        "id": 421532456,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1707944643
    },
    {
        "content": "<p>The <code>to_additive</code> seems like a doc-gen issue, <span class=\"user-mention\" data-user-id=\"395550\">@Henrik Böving</span> ?</p>",
        "id": 421532548,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1707944671
    },
    {
        "content": "<p>It might be I got the configuration of <code>to_additive</code> wrong of course.</p>\n<p>Reflecting in what went wrong here, btw, I realise I rarely build and look at documentation as I go, and I'm not even sure if this is part of the CI?</p>",
        "id": 421533012,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707944878
    },
    {
        "content": "<p>I don't have any special handling for to_additive in doc-gen.</p>",
        "id": 421536116,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707946202
    },
    {
        "content": "<p>So these strange additional theorems, they must be created by to_additive itself</p>",
        "id": 421537120,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707946612
    },
    {
        "content": "<p>I think match_1 is just generated by the equation compiler</p>",
        "id": 421537354,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707946704
    },
    {
        "content": "<p>Right. But I don't seem to have one for the originals - only the additive versions.</p>",
        "id": 421537422,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707946731
    },
    {
        "content": "<p>I think it's more likely that they also exist for the multiplicative versions, but doc-gen successfully filters them out</p>",
        "id": 421537764,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707946879
    },
    {
        "content": "<p>Aha.</p>",
        "id": 421537797,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707946892
    },
    {
        "content": "<p>I think it's more likely that they also exist for the multiplicative versions, but doc-gen successfully filters them out</p>",
        "id": 421537850,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707946914
    },
    {
        "content": "<p>So why wouldn't it filter them out for the additive versions?</p>",
        "id": 421537875,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1707946921
    },
    {
        "content": "<p>Maybe some metadata gets lost in translation? I'm not sure</p>",
        "id": 421538081,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707947013
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/doc-gen4/blob/780bbec107cba79d18ec55ac2be3907a77f27f98/DocGen4/Process/DocInfo.lean#L120-L130\">https://github.com/leanprover/doc-gen4/blob/780bbec107cba79d18ec55ac2be3907a77f27f98/DocGen4/Process/DocInfo.lean#L120-L130</a> this is the logic for filtering</p>",
        "id": 421538443,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1707947158
    },
    {
        "content": "<p>I think <code>declName.isInternal</code> is supposed to catch those</p>",
        "id": 421539162,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1707947472
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Documentation.20messed.20up.20for.20Submonoid.2Eunits/near/421532456\">said</a>:</p>\n<blockquote>\n<p>Markdown tables have different syntax depending on the parser. I can't remember which one we use, but that's my best guess without really diving in.</p>\n</blockquote>\n<p>Tables are not part of <a href=\"https://spec.commonmark.org/0.31.2/\">https://spec.commonmark.org/0.31.2/</a>, and the doc-gen4 markdown parser is the reference implementation of the spec with some math hacked on, which is much less feature-rich than what we used in Lean 3</p>",
        "id": 421541623,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1707948546
    },
    {
        "content": "<p>Bugger</p>",
        "id": 421847821,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1708085932
    },
    {
        "content": "<p>So we can't do tables at all?</p>",
        "id": 421847847,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1708085947
    },
    {
        "content": "<p>Not till we replace the markdown parser, which we already need to do anyway for non-broken math support</p>",
        "id": 421850991,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708087420
    },
    {
        "content": "<p>Fair</p>",
        "id": 421851042,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1708087442
    },
    {
        "content": "<p>Well, it would also be good to understand why I've had this to_additive issue</p>",
        "id": 421851110,
        "sender_full_name": "Wrenna Robson",
        "timestamp": 1708087455
    }
]