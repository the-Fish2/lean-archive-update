[
    {
        "content": "<p>This file seems very noisy when benchmarking for reasons I cannot figure out yet. </p>\n<p>Repeatedly running </p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>gtime<span class=\"w\"> </span>-v<span class=\"w\"> </span>lake<span class=\"w\"> </span>env<span class=\"w\"> </span>lean<span class=\"w\"> </span>--profile<span class=\"w\"> </span>Mathlib/CategoryTheory/Limits/FilteredColimitCommutesFiniteLimit.lean\n</code></pre></div>\n<p>on my machine shows the user time bounce around by 10-20%. Elaboration is the only metric that seems to vary significantly but does not account for the whole change. Does anyone have any thoughts on where to look for the missing variance?</p>",
        "id": 412410020,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1705002460
    },
    {
        "content": "<p>Wouldn't one expect user time to bounce around like this anyway? I've certainly seen outputs of <code>set_option trace.profiler true</code> bounce around. Everything is super-quick in this file except for two difficult proofs.</p>",
        "id": 412411071,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705002887
    },
    {
        "content": "<p>I am using user time on my machine as a proxy for instructions which also bounce around a lot during benchmarking. (Aside: is there really no analog of <code>perf</code> on MacOS?)</p>\n<p>While things bounce around some in general, this file an outlier for benchmarking instructions.</p>",
        "id": 412411409,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1705003021
    },
    {
        "content": "<p>I took a quick look at the file as well, I agree that it's a perplexing outlier</p>",
        "id": 412419277,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1705006432
    },
    {
        "content": "<p>OK I'm pointing my finger at the second long proof: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.colimitLimitToLimitColimit_surjective#doc\">docs#CategoryTheory.Limits.colimitLimitToLimitColimit_surjective</a> .This is a subtle proof in category theory, formalised by <span class=\"user-mention\" data-user-id=\"110087\">@Scott Morrison</span> . I'm pinging Scott because I once said to them that <code>count_heartbeats in</code> was giving me varying results, and I thought they'd claimed in response that it was supposed to be deterministic. So I'm claiming that it's highly non-deterministic in this declaration. I copied the file <code>FilteredColimitCommutesFiniteLimit.lean</code> up to and including this declaration, into a scratch file, added <code>count_heartbeats in</code> above it, and then made the following stupid file (because I'm not good at computers): </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">lake</span> <span class=\"n\">build</span> <span class=\"n\">Mathlib.scratch.scratch10</span>\n<span class=\"n\">rm</span> <span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">scratch10</span><span class=\"bp\">*</span>\n<span class=\"n\">lake</span> <span class=\"n\">build</span> <span class=\"n\">Mathlib.scratch.scratch10</span>\n<span class=\"n\">rm</span> <span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">scratch10</span><span class=\"bp\">*</span>\n<span class=\"n\">lake</span> <span class=\"n\">build</span> <span class=\"n\">Mathlib.scratch.scratch10</span>\n<span class=\"n\">rm</span> <span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lib</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">scratch</span><span class=\"bp\">/</span><span class=\"n\">scratch10</span><span class=\"bp\">*</span>\n<span class=\"bp\">...</span>\n</code></pre></div>\n<p>and let it run on my tube journey home. Grepping the output for <code>heartbeats</code> gives</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">Used</span> <span class=\"mi\">113061</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">156769</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">119662</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">117448</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">102932</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">121102</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">121290</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">122790</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">97722</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">113103</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">110243</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115873</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">114272</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115779</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108220</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">104048</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">119068</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">120746</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">110828</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">110804</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">103106</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">107728</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">112339</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">114127</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">109402</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115403</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108656</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">105474</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">128118</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108604</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115873</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">116891</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">117010</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">104934</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">113224</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">131571</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">122630</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">128894</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">120839</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">125893</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">111033</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115798</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">142694</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">111420</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">116855</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">117161</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115206</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">123498</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">129311</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">114465</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108799</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">127767</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">111308</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">118953</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">114031</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">129164</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">135640</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115803</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">116829</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">110955</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">128525</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">120924</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">132223</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">107426</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">112406</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">124224</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">109971</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">106555</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108331</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">110922</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">120041</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">127298</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">117376</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">131497</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">120933</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">139723</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">101761</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">109955</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">113512</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">127074</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">106246</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108073</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">112868</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">115719</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">108666</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">100549</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">121516</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">95127</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">107210</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">122246</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">124293</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">123156</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n<span class=\"n\">Used</span> <span class=\"mi\">113086</span> <span class=\"n\">heartbeats</span><span class=\"o\">,</span> <span class=\"n\">which</span> <span class=\"n\">is</span> <span class=\"n\">less</span> <span class=\"n\">than</span> <span class=\"n\">the</span> <span class=\"n\">current</span> <span class=\"n\">maximum</span> <span class=\"n\">of</span> <span class=\"mi\">200000</span><span class=\"bp\">.</span>\n</code></pre></div>\n<p>so the number of heartbeats which that declaration is taking varies from 95127 to 156769, an over 50% increase. Because the file is two long proofs and then a bunch of super-quick stuff, and the proof we're profiling takes about twice as long to compile as the other one, this may explain the high percentage variation picked up by the benchmarking software.</p>",
        "id": 412426179,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705009384
    },
    {
        "content": "<p>I read through the proof, and don't see anything suspicious.</p>",
        "id": 412462448,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705026378
    },
    {
        "content": "<p>If I were writing it again today I would take more effort to split it into subcomponents (in my defence I did think about this at the time; it's cumbersome to split).</p>",
        "id": 412462574,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705026461
    },
    {
        "content": "<p>The fact that there are some <code>erw</code>s is of course a red flag (although par for the course in the later parts of the category theory library...), but I really don't see anything that has an excuse for being nondeterministic!</p>",
        "id": 412462725,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705026539
    },
    {
        "content": "<p>I am still unclear on whether the answer to \"is the number of heartbeats taken by a proof supposed to be the same each time you compile it?\" is \"yes\" or \"no\". I tried it for a short proof at the beginning of that file and it was always the same.</p>",
        "id": 412504893,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705051121
    },
    {
        "content": "<p>I think the short answer is that we have not tested this hypothesis in detail yet, especially across mathlib. It certainly would be a nice invariant to have, and it is not yet clear why it is broken here.</p>",
        "id": 412505547,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1705051378
    },
    {
        "content": "<p>It is now present in the 4 of the last 5 significants runs and in 3 of them it is the only change reported.</p>",
        "id": 412555612,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1705069948
    },
    {
        "content": "<p>Should we just rewrite this proof?</p>",
        "id": 412659032,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705113241
    },
    {
        "content": "<p>I spent two hours yesterday trying to figure out which, if any, line was \"causing the problem\", by slowly moving a <code>sorry</code> down the proof and recompiling 20 times and counting heartbeats. One of my conclusions, unfortunately, was that 20 recompilations probably wasn't enough to see the statistics reliably and that perhaps 50 would be better. One thing which would be helpful, but I'm not sure how easy it would be or even if it's a meaningful concept, would be to see the number of heartbeats taken by each tactic invocation in a long proof. That way one could see whether the large spikes are happening because everything is taking a bit longer or whether one tactic is occasionally taking a lot longer.</p>\n<p>One thing I did learn from this experiment is that after a few lines the number of heartbeats starts being not completely invariant, you start getting errors of +-1, which turn into +-2 and then +-3 etc -- the error bar is typically about 1% of the total number of heartbeats. The error bar stays at 1% until about half way through the proof by which point it starts creeping up to about 2% around line 250 of the file. It was at this point that I realised that 20 iterations weren't enough because when I switched to 50 I started getting error bars of 3%. But I didn't get as far as finding the 50% variation which we see at the bottom of the proof. I did manage to convince myself that it wasn't the <code>erw</code>s though.</p>",
        "id": 412694955,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705140359
    },
    {
        "content": "<p>Sounds like you should have done binary search instead</p>",
        "id": 412754684,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1705187332
    },
    {
        "content": "<p>Yeah we don't get taught that in maths departments</p>",
        "id": 412756770,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705189218
    },
    {
        "content": "<p>I wrote a <code>heartbeat_variation in</code> wrapper that does 10 runs and reports the variations, and used this to poke at this proof a bit.</p>\n<p>It seems some of the <code>simp only</code> commands are the perpetrators, here, although I still don't understand why. I've take three of these and replaced them by explicit <code>rw</code>s, and this reduces the standard deviation in heartbeats from the 25% range to the 5% range.</p>\n<p>I'll commit the wrapper and the proof update separately.</p>",
        "id": 412771369,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705198135
    },
    {
        "content": "<p>Proof in <a href=\"https://github.com/leanprover-community/mathlib4/pull/9732\">#9732</a>, <code>heartbeat_variation in</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/9733\">#9733</a>.</p>",
        "id": 412772247,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1705198953
    },
    {
        "content": "<p>I agree with the <code>simp only</code> comment: one point in the file where I felt there seemed to be a jump in error bar percentages (from 1.5 to 3) was at a <code>simp only</code> on line 255 or so, but then I switched from 20 to 50 compilations and became less confident in this assertion, which was when I decided to give up and post what I knew.</p>",
        "id": 412809269,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1705233764
    },
    {
        "content": "<p>Could the spirit of <code>FilteredColimitCommutesFiniteLimit</code> possessed <code>Analysis.NormedSpace.Multilinear.Basic</code>?</p>",
        "id": 413023412,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1705349852
    }
]