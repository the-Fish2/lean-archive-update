[
    {
        "content": "<p>We currently have many <code>nolint simpNF</code> in Mathlib. Sometimes these are because the <code>simpNF</code> linter is <em>wrong</em>, and we really want this simp lemma. Sometime they are because the <code>simpNF</code> linter <em>crashes</em>, and we just disable it to keep going.</p>\n<p>Could someone come up with a mechanism to distinguish these? Either new syntax, or even just a standard comment?</p>\n<p>At present <code>nolint simpNF</code> is not really actionable, because it's hard to tell whether one should be thinking about simp normal forms, or thinking about why the crash is occurring.</p>",
        "id": 435927231,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1714353669
    },
    {
        "content": "<p>I had no idea there were crashes being suppressed. Do you have more information about this?</p>",
        "id": 435947904,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1714363599
    },
    {
        "content": "<p>Oh --- most of the <code>nolint simpNF</code>s in the library at this point are because the simpNF linter times out in typeclass search.</p>",
        "id": 435950898,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1714364596
    },
    {
        "content": "<p>And I've just added about 10 (maybe more?) on nightly-testing.</p>",
        "id": 435950958,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1714364612
    },
    {
        "content": "<p>I'm not sure I agree with your original diagnosis. All the <code>nolint simpNF</code> I've added come with the comment <code>-- eligible for dsimp</code>.</p>",
        "id": 435962239,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1714370972
    },
    {
        "content": "<p>What fraction of the <code>nolint simpNF</code> have such a comment?</p>",
        "id": 435962322,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1714371008
    },
    {
        "content": "<p>Not a computer, so can't check, but something like 70% in the files I work on (basic algebra files)</p>",
        "id": 435962884,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1714371335
    },
    {
        "content": "<p>A quick random sample provides messages:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"c1\">-- These lemmas have always been bad (#7657), but leanprover/lean4#2644 made `simp` start noticing</span>\n\n<span class=\"c1\">-- This lemma has always been bad, but leanprover/lean4#2644 made `simp` start noticing</span>\n\n<span class=\"c1\">-- Porting note (#10675): dsimp can not prove this</span>\n\n<span class=\"c1\">-- Porting note: `simpNF` should not trigger on `rfl` lemmas.</span>\n<span class=\"c1\">-- see https://github.com/leanprover/std4/issues/86</span>\n\n<span class=\"bp\">&lt;</span><span class=\"n\">no</span> <span class=\"n\">comment</span><span class=\"bp\">&gt;</span>\n</code></pre></div>",
        "id": 435963076,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1714371413
    }
]