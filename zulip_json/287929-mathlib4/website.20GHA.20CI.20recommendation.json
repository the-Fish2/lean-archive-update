[
    {
        "content": "<p>Yesterday I made a project that depends on Mathlib, where I copied the <code>lean_build.yml</code> and <code>upgrade_lean.yml</code> files from the community website. However, I get an error that these are deprecated and I should update to Node.js 20... How do I do that? The first file looks like this: </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">on</span><span class=\"o\">:</span>\n    <span class=\"n\">push</span><span class=\"o\">:</span>\n\n<span class=\"n\">jobs</span><span class=\"o\">:</span>\n    <span class=\"n\">update_lean_xyz_branch_and_build</span><span class=\"o\">:</span>\n        <span class=\"n\">runs</span><span class=\"bp\">-</span><span class=\"n\">on</span><span class=\"o\">:</span> <span class=\"n\">ubuntu</span><span class=\"bp\">-</span><span class=\"n\">latest</span>\n        <span class=\"n\">name</span><span class=\"o\">:</span> <span class=\"n\">Update</span> <span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">x.y.z</span> <span class=\"n\">branch</span> <span class=\"n\">and</span> <span class=\"n\">build</span> <span class=\"n\">project</span>\n        <span class=\"n\">steps</span><span class=\"o\">:</span>\n\n        <span class=\"bp\">-</span> <span class=\"n\">name</span><span class=\"o\">:</span> <span class=\"n\">checkout</span> <span class=\"n\">project</span>\n          <span class=\"n\">uses</span><span class=\"o\">:</span> <span class=\"n\">actions</span><span class=\"bp\">/</span><span class=\"n\">checkout</span><span class=\"bp\">@</span><span class=\"n\">v2</span>\n          <span class=\"k\">with</span><span class=\"o\">:</span>\n            <span class=\"n\">fetch</span><span class=\"bp\">-</span><span class=\"n\">depth</span><span class=\"o\">:</span> <span class=\"mi\">0</span>\n\n        <span class=\"bp\">-</span> <span class=\"n\">name</span><span class=\"o\">:</span> <span class=\"n\">update</span> <span class=\"n\">branch</span>\n          <span class=\"k\">if</span><span class=\"o\">:</span> <span class=\"n\">github.ref</span> <span class=\"bp\">==</span> <span class=\"bp\">'</span><span class=\"n\">refs</span><span class=\"bp\">/</span><span class=\"n\">heads</span><span class=\"bp\">/</span><span class=\"n\">master'</span>\n          <span class=\"n\">uses</span><span class=\"o\">:</span> <span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">contrib</span><span class=\"bp\">/</span><span class=\"n\">update</span><span class=\"bp\">-</span><span class=\"n\">versions</span><span class=\"bp\">-</span><span class=\"n\">action</span><span class=\"bp\">@</span><span class=\"n\">master</span>\n\n        <span class=\"bp\">-</span> <span class=\"n\">name</span><span class=\"o\">:</span> <span class=\"n\">build</span> <span class=\"n\">project</span>\n          <span class=\"n\">uses</span><span class=\"o\">:</span> <span class=\"n\">leanprover</span><span class=\"bp\">-</span><span class=\"n\">contrib</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">build</span><span class=\"bp\">-</span><span class=\"n\">action</span><span class=\"bp\">@</span><span class=\"n\">master</span>\n</code></pre></div>",
        "id": 421656226,
        "sender_full_name": "Josha Dekker",
        "timestamp": 1708004652
    },
    {
        "content": "<p>I think those are both obsolete tools from the Lean 3 era. Where did you find mentions of those?</p>",
        "id": 421679270,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708010778
    },
    {
        "content": "<p>Do we have .yml suggestions for projects depending on mathlib4?</p>",
        "id": 421679871,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708010955
    },
    {
        "content": "<p>This page : <a href=\"https://leanprover-community.github.io/install/project.html\">https://leanprover-community.github.io/install/project.html</a> has a header \"Hosting your project on GitHub\"<br>\nwhich leads me to <a href=\"https://leanprover-community.github.io/ci.html\">https://leanprover-community.github.io/ci.html</a>, where I found the scripts. What is the correct tooling now? (I'm interested in keeping Mathlib up to date in <a href=\"https://github.com/JADekker/PiBaseTracking\">https://github.com/JADekker/PiBaseTracking</a>, as the sole purpose of the repository is to keep track of progress of Mathlib for topology results.</p>",
        "id": 421679929,
        "sender_full_name": "Josha Dekker",
        "timestamp": 1708010973
    },
    {
        "content": "<p>Thanks Josha, I will nuke the second web page (note it starts with a big banner saying it is obsolete). And I will remove the corresponding sentence of the first page.</p>",
        "id": 421680310,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708011063
    },
    {
        "content": "<p>The answer to you question is that we don’t have replacement tools for Lean 4 yet. I guess this is meant to be part of the the reservoir project (see Mac Malone’s Lean Together talk).</p>",
        "id": 421680466,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708011112
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/stream/287929-mathlib4/topic/Deprecated.20Node.2Ejs.20actions/near/421680310\">said</a>:</p>\n<blockquote>\n<p>Thanks Josha, I will nuke the second web page (note it starts with a big banner saying it is obsolete). And I will remove the corresponding sentence of the first page.</p>\n</blockquote>\n<p>Yes, I saw the banner, but I couldn't find similar tools, so I figured I'd copy them and try them anyway. Thank you!</p>",
        "id": 421680624,
        "sender_full_name": "Josha Dekker",
        "timestamp": 1708011150
    },
    {
        "content": "<p>The banner could perhaps be clearer that actually <em>this specific page</em> is out of date</p>",
        "id": 421680768,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1708011188
    },
    {
        "content": "<p>I think we don't need replacement tools exactly, we just need someone to create a template github actions file based on any of the existing lean 4 projects that use CI</p>",
        "id": 421681028,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708011257
    },
    {
        "content": "<p>wrapping it up as a github action like <a href=\"https://github.com/leanprover-contrib/lean-build-action\">https://github.com/leanprover-contrib/lean-build-action</a> would be nice but IMO is not required for the purposes of the website, since it suggests a complete .yml file anyway</p>",
        "id": 421681179,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708011304
    },
    {
        "content": "<p>ideally this is something <code>lake new</code> itself would be doing, although I'm not sure how tied to github it wants to be</p>",
        "id": 421681265,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708011328
    },
    {
        "content": "<p>I just removed three pages. It would be really nice to try to port more pages. For instance I didn’t remove the page about <code>simp</code> because it used to be the most complete resource about it. One day the Lean reference manual will replace this, but in the mean time updating that webpage would be really nice.</p>",
        "id": 421681695,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708011450
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 421682497,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1708011686
    },
    {
        "content": "<p>Is there a list of pages that need porting? Maybe that would help moving it forward</p>",
        "id": 421682596,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1708011711
    },
    {
        "content": "<p>Removing the file with the .yml in it is not sufficient since if people look for one they will find one, and not the one you want them to find</p>",
        "id": 421682917,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708011800
    },
    {
        "content": "<p>15 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/stream/287929-mathlib4/topic/Deprecated.20Node.2Ejs.20actions\">#mathlib4 &gt; Deprecated Node.js actions</a> by <span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span>.</p>",
        "id": 421683163,
        "sender_full_name": "Notification Bot",
        "timestamp": 1708011874
    },
    {
        "content": "<p>Ruben:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>leanprover-community.github.io$<span class=\"w\"> </span>rg<span class=\"w\"> </span>-l<span class=\"w\"> </span>transitional\ntemplates/extras/conv.md\ntemplates/extras/calc.md\ntemplates/extras/well_founded_recursion.md\ntemplates/extras/tactic_writing.md\ntemplates/extras/simp.md\ntemplates/glossary.md\ntemplates/theories/category_theory.md\ntemplates/theories/linear_algebra.md\ntemplates/theories/sets.md\ntemplates/theories/naturals.md\ntemplates/theories/topology.md\ntemplates/lean_projects.html\ntemplates/theories.md\n</code></pre></div>",
        "id": 421684264,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012187
    },
    {
        "content": "<p>I see there are more candidates for immediate removal.</p>",
        "id": 421684558,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012265
    },
    {
        "content": "<p>I don't think any pages should be removed unless there is really no equivalent for them</p>",
        "id": 421685064,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708012396
    },
    {
        "content": "<p>The well founded recursion page for instance. I don’t see how to update it without copy-pasting Joachim’s blog post.</p>",
        "id": 421685321,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012460
    },
    {
        "content": "<p>And the theories files are probably super obsolete and a much nicer solution is to make sure their content is covered in MIL.</p>",
        "id": 421685504,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/stream/287929-mathlib4/topic/website.20GHA.20CI.20recommendation/near/421685321\">said</a>:</p>\n<blockquote>\n<p>The well founded recursion page for instance. I don’t see how to update it without copy-pasting Joachim’s blog post.</p>\n</blockquote>\n<p>from what I can see you can literally just recapitalize things and fix syntax and that page is still correct, except for the last section (which actually is also just a syntax change)</p>",
        "id": 421685811,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1708012580
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/lean_projects.html\">https://leanprover-community.github.io/lean_projects.html</a> may be already completely superseded by reservoir, even in its current state.</p>",
        "id": 421685830,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012587
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathematics_in_lean/\">#mil</a> also has the advantage that it will likely be updated more frequently than the website.</p>",
        "id": 421685850,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1708012593
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/website.20GHA.20CI.20recommendation/near/421685811\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/stream/287929-mathlib4/topic/website.20GHA.20CI.20recommendation/near/421685321\">said</a>:</p>\n<blockquote>\n<p>The well founded recursion page for instance. I don’t see how to update it without copy-pasting Joachim’s blog post.</p>\n</blockquote>\n<p>from what I can see you can literally just recapitalize things and fix syntax and that page is still correct, except for the last section (which actually is also just a syntax change)</p>\n</blockquote>\n<p>But would this be better than Joachim’s blog post?</p>",
        "id": 421685989,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012630
    },
    {
        "content": "<p>Anyway, anyone is welcome to update this page. I cannot do it because I never used well-founded recursion.</p>",
        "id": 421686106,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1708012660
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/287929-mathlib4/topic/website.20GHA.20CI.20recommendation/near/421681179\">said</a>:</p>\n<blockquote>\n<p>wrapping it up as a github action like <a href=\"https://github.com/leanprover-contrib/lean-build-action\">https://github.com/leanprover-contrib/lean-build-action</a> would be nice but IMO is not required for the purposes of the website, since it suggests a complete .yml file anyway</p>\n</blockquote>\n<p>I think <span class=\"user-mention\" data-user-id=\"321696\">@Julian Berman</span>'s <a href=\"https://github.com/Julian/setup-lean\">https://github.com/Julian/setup-lean</a> either fits the bill, or can be adapted to</p>",
        "id": 421689245,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708013476
    },
    {
        "content": "<p>(I am of course quite happy to make tweaks to that, or of course to merge any -- it's obviously completely simple and yet still useful.)</p>",
        "id": 421751320,
        "sender_full_name": "Julian Berman",
        "timestamp": 1708035895
    },
    {
        "content": "<p>I guess the main question is whether we want to have the lean3 shim inside it any more</p>",
        "id": 421752619,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708036585
    },
    {
        "content": "<p>If we drop that, presumably we can also drop the python step?</p>",
        "id": 421752636,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708036600
    },
    {
        "content": "<p>Yeah that's trivial to remove, it's there essentially because <code>lean.nvim</code> still has (frozen) support for Lean 3 but I can fix that there.</p>",
        "id": 421754105,
        "sender_full_name": "Julian Berman",
        "timestamp": 1708037352
    },
    {
        "content": "<p>Or maybe just have a branch/tag of the action with lean3 support</p>",
        "id": 421755637,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1708038156
    }
]