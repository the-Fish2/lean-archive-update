[
    {
        "content": "<p>Sometimes <code>simp</code> would make no progress where you thought it would:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">BitVec</span> <span class=\"mi\">32</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"mi\">5</span><span class=\"bp\">#</span><span class=\"mi\">32</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"k\">match</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"bp\">&gt;&gt;&gt;</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"mi\">2</span><span class=\"bp\">#</span><span class=\"mi\">32</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">True</span>\n  <span class=\"bp\">|</span> <span class=\"n\">_</span>    <span class=\"bp\">=&gt;</span> <span class=\"n\">False</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n  <span class=\"n\">simp</span><span class=\"bp\">?</span> <span class=\"c1\">-- simp only [BitVec.reduceHShiftRight, _example.match_1.eq_1]</span>\n        <span class=\"c1\">--            BitVec.reduceHShiftRight is built in</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">Nat</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"mi\">5</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"k\">match</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"bp\">&gt;&gt;&gt;</span> <span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">#</span><span class=\"mi\">32</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"mi\">2</span><span class=\"bp\">#</span><span class=\"mi\">32</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">True</span>\n  <span class=\"bp\">|</span> <span class=\"n\">_</span>    <span class=\"bp\">=&gt;</span> <span class=\"n\">False</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n  <span class=\"n\">simp</span> <span class=\"c1\">-- no progress</span>\n\n<span class=\"kd\">example</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"o\">:</span> <span class=\"n\">UInt8</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"n\">x</span> <span class=\"bp\">=</span> <span class=\"mi\">5</span><span class=\"o\">)</span> <span class=\"o\">:</span>\n  <span class=\"k\">match</span> <span class=\"o\">(</span><span class=\"n\">x</span> <span class=\"bp\">&gt;&gt;&gt;</span> <span class=\"mi\">1</span><span class=\"o\">)</span> <span class=\"k\">with</span>\n  <span class=\"bp\">|</span> <span class=\"mi\">2</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">True</span>\n  <span class=\"bp\">|</span> <span class=\"n\">_</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">False</span> <span class=\"o\">:=</span> <span class=\"kd\">by</span>\n  <span class=\"n\">rw</span> <span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n  <span class=\"n\">simp</span> <span class=\"c1\">-- no progress</span>\n</code></pre></div>\n<p>It turned out that BitVec.reduceHShiftRight is <code>builtin_dsimproc</code>. Should we add this for HShift of Nat and UInt?</p>",
        "id": 425811394,
        "sender_full_name": "Casavaca",
        "timestamp": 1710109915
    },
    {
        "content": "<p>Yes, this sounds reasonable.</p>",
        "id": 426066019,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1710227604
    }
]