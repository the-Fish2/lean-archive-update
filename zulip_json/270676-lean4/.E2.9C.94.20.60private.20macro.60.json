[
    {
        "content": "<p>Why cannot I declare a <code>private macro</code> in my file?</p>",
        "id": 438537020,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715679128
    },
    {
        "content": "<p>Not trying to be rude, but I think the answer is simply that private macros aren't supported</p>",
        "id": 438537714,
        "sender_full_name": "Arthur Paulino",
        "timestamp": 1715679382
    },
    {
        "content": "<p>If there is no reason why it shouldn't be supported, I'll make a RFC for it.</p>",
        "id": 438537821,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715679427
    },
    {
        "content": "<p>You can scope macros:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">namespace</span> <span class=\"n\">MyMacro</span>\n\n<span class=\"n\">scoped</span> <span class=\"n\">macro</span> <span class=\"s2\">\"hi\"</span> <span class=\"n\">cmd</span><span class=\"o\">:</span><span class=\"n\">command</span> <span class=\"o\">:</span> <span class=\"n\">command</span> <span class=\"bp\">=&gt;</span> <span class=\"n\">dbg_trace</span> <span class=\"s2\">\"hi\"</span><span class=\"bp\">;</span> <span class=\"n\">return</span> <span class=\"bp\">←</span> <span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">command</span><span class=\"bp\">|</span> <span class=\"bp\">$</span><span class=\"n\">cmd</span><span class=\"o\">)</span>\n\n<span class=\"n\">hi</span>  <span class=\"c1\">-- works</span>\n<span class=\"k\">#eval</span> <span class=\"mi\">0</span>\n\n<span class=\"kd\">end</span> <span class=\"n\">MyMacro</span>\n\n<span class=\"n\">hi</span>  <span class=\"c1\">-- unexpected identifier; expected command</span>\n<span class=\"k\">#eval</span> <span class=\"mi\">0</span>\n\n<span class=\"kn\">open</span> <span class=\"n\">scoped</span> <span class=\"n\">MyMacro</span> <span class=\"k\">in</span>\n<span class=\"n\">hi</span>  <span class=\"c1\">-- works</span>\n<span class=\"k\">#eval</span> <span class=\"mi\">0</span>\n</code></pre></div>",
        "id": 438538190,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1715679595
    },
    {
        "content": "<p>All right, but that's too much work. I just want to mark everything that can be private <code>private</code> without any overhead.</p>",
        "id": 438538467,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715679690
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/270676-lean4/topic/.60private.20macro.60/near/438538467\">said</a>:</p>\n<blockquote>\n<p>All right, but that's too much work. I just want to mark everything that can be private <code>private</code> without any overhead.</p>\n</blockquote>\n<p>You could probably write a scoped macro for that... <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 438538775,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1715679806
    },
    {
        "content": "<p>That kinda discourages people from making everything <code>private</code> by default.</p>",
        "id": 438538910,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715679847
    },
    {
        "content": "<p>Oh, I got the joke now!</p>",
        "id": 438539065,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715679909
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> <a href=\"#narrow/stream/270676-lean4/topic/.60private.20macro.60/near/438537821\">said</a>:</p>\n<blockquote>\n<p>If there is no reason why it shouldn't be supported, I'll make a RFC for it.</p>\n</blockquote>\n<p>I think this is not really the way we'd like people to think about the RFC process. How about \"if it's really important, and would be useful to lots of people, I'll make an RFC for it\"? :-)</p>",
        "id": 438540660,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715680476
    },
    {
        "content": "<p>You are totally right about RFCs in general. Here, however, it should be a small non-controversial change (that people would support but not necessarily care about).</p>",
        "id": 438540966,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715680582
    },
    {
        "content": "<p>I think you are underestimating the effort (if only in context switching) required to effect \"small changes\", and if no one cares then raising it in the first place is counterproductive.</p>",
        "id": 438541106,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715680649
    },
    {
        "content": "<p>All right, I'll take your word for it and I will not create the RFC.</p>",
        "id": 438541254,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1715680693
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"417654\">Martin Dvořák</span> has marked this topic as resolved.</p>",
        "id": 438541359,
        "sender_full_name": "Notification Bot",
        "timestamp": 1715680738
    },
    {
        "content": "<p>Probably too late, but I've also hoped for private macros before.</p>",
        "id": 438549241,
        "sender_full_name": "Marcus Rossel",
        "timestamp": 1715683772
    },
    {
        "content": "<p>(If I'm mistaken about users wanting it, that's fine!)</p>",
        "id": 438551758,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1715684773
    },
    {
        "content": "<p>There's <code>local macro</code>, right?</p>",
        "id": 438605683,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1715702042
    },
    {
        "content": "<p>Regarding RFCs, they're different from feature requests. It takes longer than five minutes to decide to start writing an RFC. Ideally, you have collected some examples where a feature would be useful, thought a bit about alternative approaches, and have had enough time to have a discussion about all of this, for writing a strong RFC.</p>\n<p>For example, Damiano's idea of scoped macros is an alternative, and the RFC needs to argue what <code>private macro</code> enables that <code>scoped macro</code> does not. Or, now that I've seen this thread six hours later, what <code>private macro</code> enables that <code>local macro</code> does not. The difference here seems like a very small technical one.</p>\n<p>It seems to me that, if there's an RFC in here, it might be to have <code>private macro</code> create an error that directs you to <code>local macro</code>?</p>",
        "id": 438608040,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1715702781
    }
]