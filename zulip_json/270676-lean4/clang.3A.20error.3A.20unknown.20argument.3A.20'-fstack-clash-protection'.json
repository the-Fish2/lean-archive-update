[
    {
        "content": "<p>I'm trying to build Lean core (<a href=\"#narrow/stream/270676-lean4/topic/gotcha.20in.20constructor.20tactic/near/410659786\">reason</a>).  Here's where things started to go wrong:</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>[ 61%] Building CXX object library/compiler/CMakeFiles/compiler.dir/ir.cpp.o\n[ 61%] Building CXX object library/compiler/CMakeFiles/compiler.dir/implemented_by_attribute.cpp.o\n[ 62%] Building CXX object library/compiler/CMakeFiles/compiler.dir/ir_interpreter.cpp.o\n[ 63%] Building CXX object library/compiler/CMakeFiles/compiler.dir/llvm.cpp.o\n[ 63%] Built target compiler\n[ 63%] Linking CXX static library lib/lean/libleancpp.a\n[ 63%] Built target leancpp\n[    ] Building ../stdlib//Init/NotationExtra.c\nclang: error: unknown argument: '-fstack-clash-protection'\nmake[7]: *** [../../build/release/stage0/lib/temp/Init/NotationExtra.o] Error 1\nmake[6]: *** [Init] Error 2\nmake[5]: *** [CMakeFiles/make_stdlib] Error 2\nmake[4]: *** [CMakeFiles/make_stdlib.dir/all] Error 2\nmake[3]: *** [all] Error 2\nmake[2]: *** [stage0-prefix/src/stage0-stamp/stage0-build] Error 2\nmake[1]: *** [CMakeFiles/stage0.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre></div>\n<p>Can anyone troubleshoot this?</p>",
        "id": 410662565,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1704059809
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> what is the version of your clang? stack-clash-protection is a flag from 2020 so if your thing is too old it might not have this yet. The solution would be to...pretty much get a clang that is not almost 4 years old</p>",
        "id": 410662714,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1704060015
    },
    {
        "content": "<p>Are you on linux? Maybe try running the <code>sudo apt-get install git libgmp-dev cmake ccache clang</code> line again</p>",
        "id": 410662820,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704060089
    },
    {
        "content": "<p>I'm on an old MacOS (Catalina).  But <code>cmake --version</code> says</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>cmake version 3.28.1\n</code></pre></div>\n<p>which appears to be the latest.</p>",
        "id": 410662979,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1704060184
    },
    {
        "content": "<p>what about <code>clang --version</code>?</p>",
        "id": 410663000,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704060200
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>Apple clang version 12.0.0 (clang-1200.0.26.2)\nTarget: x86_64-apple-darwin19.6.0\nThread model: posix\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\n</code></pre></div>",
        "id": 410663031,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1704060227
    },
    {
        "content": "<p>cmake is the thing that figures out what clang commands to run, clang is the thing that translates C so they can be completely different</p>",
        "id": 410663033,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1704060231
    },
    {
        "content": "<p>I get</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">Ubuntu</span> <span class=\"n\">clang</span> <span class=\"n\">version</span> <span class=\"mi\">14</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">0</span><span class=\"bp\">-</span><span class=\"mi\">1</span><span class=\"n\">ubuntu1.1</span>\n<span class=\"n\">Target</span><span class=\"o\">:</span> <span class=\"n\">x86_64</span><span class=\"bp\">-</span><span class=\"n\">pc</span><span class=\"bp\">-</span><span class=\"n\">linux</span><span class=\"bp\">-</span><span class=\"n\">gnu</span>\n<span class=\"n\">Thread</span> <span class=\"n\">model</span><span class=\"o\">:</span> <span class=\"n\">posix</span>\n<span class=\"n\">InstalledDir</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">bin</span>\n</code></pre></div>",
        "id": 410663035,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704060236
    },
    {
        "content": "<p>clang 12 is very early 2021, so I would guess you are probably exactly one version off</p>",
        "id": 410663090,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1704060280
    },
    {
        "content": "<p>Do you happen to know how to update clang on MacOS?</p>",
        "id": 410663172,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1704060384
    },
    {
        "content": "<p>I believe clang is part of the apple developer tools? So however you might update those...</p>",
        "id": 410663197,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1704060427
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/questions/74744762/how-can-i-upgrade-the-built-in-apple-clang-on-macos\">https://stackoverflow.com/questions/74744762/how-can-i-upgrade-the-built-in-apple-clang-on-macos</a></p>",
        "id": 410663208,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704060460
    },
    {
        "content": "<p>I cannot vouch for any of the things written there though</p>",
        "id": 410663221,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1704060479
    }
]