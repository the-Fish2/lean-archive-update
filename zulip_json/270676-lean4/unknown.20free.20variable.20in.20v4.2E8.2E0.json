[
    {
        "content": "<p>Hi. I updated my project to v4.8.0 and started to get an <code>unknown free variable: _kernel_fresh.19</code> error. Here is the MWE:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">NFA</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">nodes</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">nfa</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NFA</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">nfa</span><span class=\"bp\">.</span><span class=\"n\">nodes</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">nfa</span><span class=\"bp\">.</span><span class=\"n\">nodes</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span>\n\n<span class=\"c1\">-- \"unknown free variable: _kernel_fresh.19\" at instance</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GetElem</span><span class=\"w\"> </span><span class=\"n\">NFA</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">nfa</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">nfa</span><span class=\"bp\">.</span><span class=\"n\">nodes</span><span class=\"bp\">.</span><span class=\"n\">size</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">getElem</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">get</span>\n</code></pre></div>\n<p>Spelling out all arguments of <code>getElem</code> like <code>getElem nfa i h := get nfa i h</code> seems to fix the issue though.</p>",
        "id": 443754071,
        "sender_full_name": "pandaman",
        "timestamp": 1718020804
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"395416\">@pandaman</span>, can you please report this as an issue on the <code>lean4</code> repository?</p>",
        "id": 443754618,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1718020971
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/leanprover/lean4/issues/4418\">https://github.com/leanprover/lean4/issues/4418</a></p>",
        "id": 443759620,
        "sender_full_name": "pandaman",
        "timestamp": 1718022548
    },
    {
        "content": "<p>Could you please add which version you were upgrading from (i.e. where this code used to work?)</p>",
        "id": 443761061,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1718022968
    },
    {
        "content": "<p>Added the original version (v4.6.0)!</p>",
        "id": 443761621,
        "sender_full_name": "pandaman",
        "timestamp": 1718023173
    }
]